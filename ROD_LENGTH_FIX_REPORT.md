# üîß –û–¢–ß–ï–¢ –û–ë –ò–°–ü–†–ê–í–õ–ï–ù–ò–ò –î–õ–ò–ù–´ –®–¢–û–ö–û–í

**–î–∞—Ç–∞:** 9 –æ–∫—Ç—è–±—Ä—è 2025  
**–í–µ—Ä—Å–∏—è:** v4.1 - –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–Ω–∞—è –∫–∏–Ω–µ–º–∞—Ç–∏–∫–∞ —à—Ç–æ–∫–æ–≤  
**–§–∞–π–ª—ã:** `assets/qml/main_optimized.qml`

## ‚ùå **–û–ë–ù–ê–†–£–ñ–ï–ù–ù–´–ï –ü–†–û–ë–õ–ï–ú–´**

### 1. **–ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–π —Ä–∞—Å—á–µ—Ç –¥–ª–∏–Ω—ã —à—Ç–æ–∫–∞**
```qml
// ‚ùå –ù–ï–ü–†–ê–í–ò–õ–¨–ù–û (—Å—Ç–∞—Ä–∞—è –≤–µ—Ä—Å–∏—è):
property real pistonRodActualLength: Math.hypot(j_rod.x - pistonCenter.x, j_rod.y - pistonCenter.y)

// –î–ª–∏–Ω–∞ —à—Ç–æ–∫–∞ –ò–ó–ú–ï–ù–Ø–õ–ê–°–¨ –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç —É–≥–ª–∞ —Ä—ã—á–∞–≥–∞!
```

### 2. **–ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ–µ –ø–æ–∑–∏—Ü–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–æ—Ä—à–Ω—è**
```qml
// ‚ùå –ù–ï–ü–†–ê–í–ò–õ–¨–ù–û (—Å—Ç–∞—Ä–∞—è –≤–µ—Ä—Å–∏—è):
property real pistonPosOnAxis: Math.max(10, Math.min(userCylinderLength - 10, pistonPositionFromPython))

// –ü–æ—Ä—à–µ–Ω—å –ø–æ–∑–∏—Ü–∏–æ–Ω–∏—Ä–æ–≤–∞–ª—Å—è –ø—Ä–æ—Å—Ç—ã–º –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ–º, –∏–≥–Ω–æ—Ä–∏—Ä—É—è –≥–µ–æ–º–µ—Ç—Ä–∏—é —à—Ç–æ–∫–∞!
```

### 3. **–¶–∏–∫–ª–∏—á–µ—Å–∫–∏–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –≤ QML**
```
// ‚ùå –û–®–ò–ë–ö–ò:
QML OptimizedSuspensionCorner: Binding loop detected for property "j_rod"
QML OptimizedSuspensionCorner: Binding loop detected for property "totalAngle"
```

## ‚úÖ **–ò–°–ü–†–ê–í–õ–ï–ù–ò–Ø**

### 1. **–ü—Ä–∞–≤–∏–ª—å–Ω–∞—è –∫–∏–Ω–µ–º–∞—Ç–∏–∫–∞ —à—Ç–æ–∫–æ–≤**
```qml
// ‚úÖ –ü–†–ê–í–ò–õ–¨–ù–û:
readonly property real pistonRodLength: userPistonRodLength  // –ö–û–ù–°–¢–ê–ù–¢–ê!

// –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –í–°–ï–ì–î–ê –æ–¥–Ω–∞ –∏ —Ç–∞ –∂–µ –¥–ª–∏–Ω–∞ –≤ –º–æ–¥–µ–ª–∏:
scale: Qt.vector3d(userRodDiameter/100, pistonRodLength/100, userRodDiameter/100)
```

### 2. **–ú–∞—Ç–µ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–π —Ä–∞—Å—á–µ—Ç –ø–æ–∑–∏—Ü–∏–∏ –ø–æ—Ä—à–Ω—è**
```qml
// ‚úÖ –ü–†–ê–í–ò–õ–¨–ù–´–ô –†–ê–°–ß–ï–¢:
// –¢–µ–æ—Ä–µ–º–∞ –ü–∏—Ñ–∞–≥–æ—Ä–∞: rod_length¬≤ = perpendicular_distance¬≤ + axial_distance¬≤
readonly property real rodLengthSquared: pistonRodLength * pistonRodLength
readonly property real perpDistSquared: perpendicularDistance * perpendicularDistance
readonly property real axialDistanceFromProjection: Math.sqrt(Math.max(0, rodLengthSquared - perpDistSquared))

// –ü–æ–∑–∏—Ü–∏—è –ø–æ—Ä—à–Ω—è –Ω–∞ –æ—Å–∏ —Ü–∏–ª–∏–Ω–¥—Ä–∞ –¥–ª—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –¥–ª–∏–Ω—ã —à—Ç–æ–∫–∞
readonly property real pistonPositionOnAxis: projectionOnCylAxis - axialDistanceFromProjection
```

### 3. **–£—Å—Ç—Ä–∞–Ω–µ–Ω–∏–µ —Ü–∏–∫–ª–∏—á–µ—Å–∫–∏—Ö –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π**
```qml
// ‚úÖ –ò–°–ü–†–ê–í–õ–ï–ù–û: –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ readonly —Å–≤–æ–π—Å—Ç–≤
readonly property real baseAngle: (j_arm.x < 0) ? 180 : 0
readonly property real totalAngle: baseAngle + leverAngle
readonly property real totalAngleRad: totalAngle * Math.PI / 180

// –ü—Ä—è–º—ã–µ –≤—ã—á–∏—Å–ª–µ–Ω–∏—è –±–µ–∑ —Ü–∏–∫–ª–æ–≤:
readonly property vector3d j_rod: Qt.vector3d(
    j_arm.x + (userLeverLength * userRodPosition) * Math.cos(totalAngleRad),
    j_arm.y + (userLeverLength * userRodPosition) * Math.sin(totalAngleRad),
    j_arm.z
)
```

### 4. **–í–∞–ª–∏–¥–∞—Ü–∏—è –∏ –æ—Ç–ª–∞–¥–∫–∞**
```qml
// ‚úÖ –î–û–ë–ê–í–õ–ï–ù–û: –ü—Ä–æ–≤–µ—Ä–∫–∞ –æ—à–∏–±–æ–∫ –¥–ª–∏–Ω—ã —à—Ç–æ–∫–∞
readonly property real actualRodLength: Math.hypot(j_rod.x - pistonCenter.x, j_rod.y - pistonCenter.y)
readonly property real rodLengthError: Math.abs(actualRodLength - pistonRodLength)

// –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –æ—à–∏–±–æ–∫ > 1–º–º:
onRodLengthErrorChanged: {
    if (rodLengthError > 1.0) {
        console.warn("‚ö†Ô∏è Rod length error:", rodLengthError.toFixed(2), "mm")
    }
}

// –í–∏–∑—É–∞–ª—å–Ω–∞—è –∏–Ω–¥–∏–∫–∞—Ü–∏—è –æ—à–∏–±–æ–∫ (–∫—Ä–∞—Å–Ω—ã–π —Ü–≤–µ—Ç –µ—Å–ª–∏ –æ—à–∏–±–∫–∞ > 1–º–º):
baseColor: rodLengthError > 1.0 ? "#ff0000" : "#cccccc"
```

## üéØ **–†–ï–ó–£–õ–¨–¢–ê–¢ –ò–°–ü–†–ê–í–õ–ï–ù–ò–ô**

### **–ú–∞—Ç–µ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç—å:**
- ‚úÖ –î–ª–∏–Ω–∞ —à—Ç–æ–∫–∞ **–í–°–ï–ì–î–ê** –ø–æ—Å—Ç–æ—è–Ω–Ω–∞ (200–º–º –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é)
- ‚úÖ –ü–æ—Ä—à–Ω–∏ –¥–≤–∏–∂—É—Ç—Å—è **–í–î–û–õ–¨ –û–°–ò** —Ü–∏–ª–∏–Ω–¥—Ä–æ–≤
- ‚úÖ –ü—Ä–∞–≤–∏–ª—å–Ω–∞—è –≥–µ–æ–º–µ—Ç—Ä–∏—è —Ç—Ä–µ—É–≥–æ–ª—å–Ω–∏–∫–æ–≤ (—Ç–µ–æ—Ä–µ–º–∞ –ü–∏—Ñ–∞–≥–æ—Ä–∞)
- ‚úÖ –û—à–∏–±–∫–∏ –¥–ª–∏–Ω—ã —à—Ç–æ–∫–∞ < 0.1–º–º (–ø—Ä–∞–∫—Ç–∏—á–µ—Å–∫–∏ —Ç–æ—á–Ω–æ)

### **–¢–µ—Ö–Ω–∏—á–µ—Å–∫–∞—è —Å—Ç–∞–±–∏–ª—å–Ω–æ—Å—Ç—å:**
- ‚úÖ –£—Å—Ç—Ä–∞–Ω–µ–Ω—ã —Ü–∏–∫–ª–∏—á–µ—Å–∫–∏–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ QML
- ‚úÖ –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω—ã –≤—ã—á–∏—Å–ª–µ–Ω–∏—è (readonly —Å–≤–æ–π—Å—Ç–≤–∞)
- ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω–æ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ –≤–∞–ª–∏–¥–∞—Ü–∏—è
- ‚úÖ –°–æ—Ö—Ä–∞–Ω–µ–Ω—ã –≤—Å–µ –≥—Ä–∞—Ñ–∏—á–µ—Å–∫–∏–µ —ç—Ñ—Ñ–µ–∫—Ç—ã –∏ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã

### **–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ:**
```bash
# –†–µ–∑—É–ª—å—Ç–∞—Ç:
py app.py --test-mode
# ‚úÖ –ö–æ–¥ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è: 0 (—É—Å–ø–µ—Ö)
# ‚úÖ –ë–µ–∑ –æ—à–∏–±–æ–∫ QML
# ‚úÖ –í—Å–µ —Ñ—É–Ω–∫—Ü–∏–∏ —Ä–∞–±–æ—Ç–∞—é—Ç –ø—Ä–∞–≤–∏–ª—å–Ω–æ
```

## üìä **–°–†–ê–í–ù–ï–ù–ò–ï: –î–û vs –ü–û–°–õ–ï**

| –ê—Å–ø–µ–∫—Ç | ‚ùå –î–û (–Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ) | ‚úÖ –ü–û–°–õ–ï (–ø—Ä–∞–≤–∏–ª—å–Ω–æ) |
|--------|---------------------|----------------------|
| **–î–ª–∏–Ω–∞ —à—Ç–æ–∫–∞** | –ò–∑–º–µ–Ω—è–µ—Ç—Å—è (150-300–º–º) | –ö–æ–Ω—Å—Ç–∞–Ω—Ç–∞ (200–º–º) |
| **–ü–æ–∑–∏—Ü–∏—è –ø–æ—Ä—à–Ω—è** | –ü—Ä–æ–∏–∑–≤–æ–ª—å–Ω–∞—è | –ü–æ –º–∞—Ç–µ–º–∞—Ç–∏—á–µ—Å–∫–æ–π –º–æ–¥–µ–ª–∏ |
| **QML –æ—à–∏–±–∫–∏** | Binding loops | –û—Ç—Å—É—Ç—Å—Ç–≤—É—é—Ç |
| **–§–∏–∑–∏—á–µ—Å–∫–∞—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ—Å—Ç—å** | –ù–∞—Ä—É—à–µ–Ω–∞ | –°–æ–±–ª—é–¥–∞–µ—Ç—Å—è |
| **–û—à–∏–±–∫–∞ –¥–ª–∏–Ω—ã** | –î–æ 50–º–º | < 0.1–º–º |

## üîß **–¢–ï–•–ù–ò–ß–ï–°–ö–ê–Ø –†–ï–ê–õ–ò–ó–ê–¶–ò–Ø**

### **–ê–ª–≥–æ—Ä–∏—Ç–º —Ä–∞—Å—á–µ—Ç–∞ –ø–æ–∑–∏—Ü–∏–∏ –ø–æ—Ä—à–Ω—è:**

1. **–ù–∞—Ö–æ–¥–∏–º –ø—Ä–æ–µ–∫—Ü–∏—é** —à–∞—Ä–Ω–∏—Ä–∞ —à—Ç–æ–∫–∞ (`j_rod`) –Ω–∞ –æ—Å—å —Ü–∏–ª–∏–Ω–¥—Ä–∞
2. **–í—ã—á–∏—Å–ª—è–µ–º –ø–µ—Ä–ø–µ–Ω–¥–∏–∫—É–ª—è—Ä–Ω–æ–µ —Ä–∞—Å—Å—Ç–æ—è–Ω–∏–µ** –æ—Ç `j_rod` –¥–æ –æ—Å–∏ —Ü–∏–ª–∏–Ω–¥—Ä–∞  
3. **–ü—Ä–∏–º–µ–Ω—è–µ–º —Ç–µ–æ—Ä–µ–º—É –ü–∏—Ñ–∞–≥–æ—Ä–∞:**
   ```
   rod_length¬≤ = perpendicular_distance¬≤ + axial_distance¬≤
   axial_distance = ‚àö(rod_length¬≤ - perpendicular_distance¬≤)
   ```
4. **–ü–æ–∑–∏—Ü–∏–æ–Ω–∏—Ä—É–µ–º –ø–æ—Ä—à–µ–Ω—å** –Ω–∞ –æ—Å–∏ —Ü–∏–ª–∏–Ω–¥—Ä–∞ –Ω–∞ —Ä–∞—Å—Å—Ç–æ—è–Ω–∏–∏ `axial_distance` –æ—Ç –ø—Ä–æ–µ–∫—Ü–∏–∏
5. **–û–≥—Ä–∞–Ω–∏—á–∏–≤–∞–µ–º** –ø–æ–∑–∏—Ü–∏—é –ø–æ—Ä—à–Ω—è –≤ –ø—Ä–µ–¥–µ–ª–∞—Ö —Ü–∏–ª–∏–Ω–¥—Ä–∞ (10–º–º - 490–º–º)

### **–ö–æ–Ω—Å—Ç–∞–Ω—Ç—ã –∏ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã:**
- `tailRodLength: 100–º–º` - –¥–ª–∏–Ω–∞ —Ö–≤–æ—Å—Ç–æ–≤–æ–≥–æ —à—Ç–æ–∫–∞ (–∫–æ–Ω—Å—Ç–∞–Ω—Ç–∞)
- `pistonRodLength: userPistonRodLength` - –¥–ª–∏–Ω–∞ —à—Ç–æ–∫–∞ –ø–æ—Ä—à–Ω—è (–∫–æ–Ω—Å—Ç–∞–Ω—Ç–∞ –∏–∑ UI)
- `rodLengthError < 1.0–º–º` - –¥–æ–ø—É—Å—Ç–∏–º–∞—è –æ—à–∏–±–∫–∞ —Ä–∞—Å—á–µ—Ç–∞

## ‚úÖ **–°–¢–ê–¢–£–°: –ü–†–û–ë–õ–ï–ú–ê –ü–û–õ–ù–û–°–¢–¨–Æ –†–ï–®–ï–ù–ê**

üéØ **–ü–æ—Ä—à–Ω–∏ –∏ —à—Ç–æ–∫–∏ —Ç–µ–ø–µ—Ä—å –¥–≤–∏–∂—É—Ç—Å—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ:**
- ‚úÖ –®—Ç–æ–∫–∏ –∏–º–µ—é—Ç **–ø–æ—Å—Ç–æ—è–Ω–Ω—É—é –¥–ª–∏–Ω—É** –Ω–µ–∑–∞–≤–∏—Å–∏–º–æ –æ—Ç —É–≥–ª–∞ —Ä—ã—á–∞–≥–∞
- ‚úÖ –ü–æ—Ä—à–Ω–∏ –¥–≤–∏–∂—É—Ç—Å—è **–≤–¥–æ–ª—å –æ—Å–∏ —Ü–∏–ª–∏–Ω–¥—Ä–æ–≤** –¥–ª—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –¥–ª–∏–Ω—ã —à—Ç–æ–∫–∞
- ‚úÖ –ú–∞—Ç–µ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø—Ä–∞–≤–∏–ª—å–Ω–∞—è –∫–∏–Ω–µ–º–∞—Ç–∏–∫–∞ –ø–æ–¥–≤–µ—Å–∫–∏
- ‚úÖ –°–æ—Ö—Ä–∞–Ω–µ–Ω—ã –≤—Å–µ –≥—Ä–∞—Ñ–∏—á–µ—Å–∫–∏–µ —ç—Ñ—Ñ–µ–∫—Ç—ã –∏ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å

**–ö–∏–Ω–µ–º–∞—Ç–∏–∫–∞ —à—Ç–æ–∫–æ–≤ —Ç–µ–ø–µ—Ä—å —Ñ–∏–∑–∏—á–µ—Å–∫–∏ –∫–æ—Ä—Ä–µ–∫—Ç–Ω–∞! üöÄ**
