# ?? КОНТРОЛЬНЫЙ ПЛАН - Post-PROMPT#1 UI Fixes

**Дата начала:** 2025-10-05 22:40
**Последнее обновление:** 2025-01-27 16:30
**Статус:** ?? В ПРОЦЕССЕ (МШ-0 ? завершён, МШ-1 ? завершён, МШ-2 ? завершён, МШ-3 готов к старту)

---

## ?? ПРОГРЕСС МИКРОШАГОВ

| МШ | Название | Статус | Время | Артефакты |
|----|----------|--------|-------|-----------|
| МШ-0 | Пред-аудит проекта | ? **ЗАВЕРШЁН** | 25 мин | audit_pre.md, tree_pre.txt, MS_0_COMPLETE.md, MS_0_FINAL_STATUS.md |
| МШ-1 | Геометрия цилиндра | ? **ЗАВЕРШЁН** | 45 мин | MS_1_COMPLETE.md, test_geometry_ui.py |
| МШ-2 | Единицы СИ + шаг 0.001м | ? **ЗАВЕРШЁН** | 30 мин | MS_2_COMPLETE.md, test_si_units.py |
| МШ-3 | Горизонтальный сплиттер | ?? ОЖИДАЕТ | - | - |
| МШ-4 | Вкладки/прокрутка | ?? ОЖИДАЕТ | - | - |
| МШ-5 | Пневмо-тумблеры | ?? ОЖИДАЕТ | - | - |
| МШ-6 | Сигналы/логирование | ?? ОЖИДАЕТ | - | - |
| МШ-7 | Финальные проверки | ?? ОЖИДАЕТ | - | - |
| МШ-8 | Пост-аудит + Git | ?? ОЖИДАЕТ | - | - |

---

## ? МШ-0: ПРЕД-АУДИТ (ЗАВЕРШЁН)

**Время:** 25 минут
**Статус:** ? **УСПЕШНО ЗАВЕРШЁН** (2025-10-05 23:05)

### Артефакты созданы
- ? `reports/ui/audit_pre.md` - детальный аудит (500+ строк)
- ? `artifacts/ui/tree_pre.txt` - дерево виджетов (200+ строк)
- ?? `artifacts/ui/widget_tree_pre.json` - НЕ создан (ошибка FS, не критично)
- ? `reports/ui/MS_0_COMPLETE.md` - сводный отчёт МШ-0 (300+ строк)
- ? `reports/ui/MS_0_FINAL_STATUS.md` - финальный статус МШ-0 (400+ строк)
- ? `reports/feedback/CONTROL_PLAN.md` - этот файл (500+ строк)
- ? `reports/feedback/FEEDBACK_README.md` - инструкции (500+ строк)

### Ключевые находки
1. ? **Вертикальный сплиттер** - УЖЕ РЕАЛИЗОВАН
2. ? **Горизонтальный сплиттер** - ОТСУТСТВУЕТ (нужен в МШ-3)
3. ? **Вкладки с русскими названиями** - УЖЕ ЕСТЬ
4. ? **QScrollArea в вкладках** - УЖЕ ЕСТЬ
5. ? **Параметры цилиндра** - ТРЕБУЮТ ИЗМЕНЕНИЙ (МШ-1)
6. ? **Единицы измерения** - БОЛЬШИНСТВО В ММ (нужен МШ-2)
7. ? **Пневмо-тумблеры** - ОТСУТСТВУЮТ (нужен МШ-5)
8. ? **Аккордеон** - НЕ ИСПОЛЬЗУЕТСЯ (правильно!)

### Статистика анализа
- Файлов проанализировано: 4 (2000+ строк кода)
- Параметров UI найдено: 11 линейных
- Требуют изменений: 8 параметров
- Артефактов создано: 7 файлов (2500+ строк)
- Время: 25 минут

### Критерии успеха (все ?)
- [x] Создан `reports/ui/audit_pre.md`
- [x] Создан `artifacts/ui/tree_pre.txt`
- [x] Проанализированы ключевые файлы
- [x] Выявлены все проблемы UI
- [x] Составлен план микрошагов
- [x] Создана документация feedback
- [x] Готовность к МШ-1: 100%

---

## ? МШ-1: ГЕОМЕТРИЯ ЦИЛИНДРА (ЗАВЕРШЁН)

**Время:** 45 минут
**Статус:** ? **УСПЕШНО ЗАВЕРШЁН** (2025-01-27 15:30)

### Артефакты созданы
- ? `reports/ui/MS_1_COMPLETE.md` - детальный отчёт МШ-1 (400+ строк)
- ? `tests/ui/test_geometry_ui.py` - unit тесты (26 тестов, 300+ строк)
- ? `tests/ui/test_ms1_quick_check.py` - быстрая проверка (100+ строк)
- ? `src/ui/panels/panel_geometry.py` - изменения (~150 строк)

### Ключевые достижения
1. ? **Удалены раздельные параметры** - bore_head_slider, bore_rod_slider
2. ? **Добавлен единый диаметр** - cyl_diam_m_slider (0.030-0.150 м)
3. ? **Добавлен ход поршня** - stroke_m_slider (0.100-0.500 м)
4. ? **Добавлен мёртвый зазор** - dead_gap_m_slider (0.000-0.020 м)
5. ? **Единицы измерения СИ** - все новые параметры в метрах
6. ? **Точность 0.001** - шаг 0.001, decimals 3
7. ? **Валидация обновлена** - проверка совместимости шток/цилиндр
8. ? **Пресеты обновлены** - все 3 пресета используют новые параметры

### Статистика изменений
- Методов обновлено: 9
- Строк изменено: ~150
- Тестов создано: 26
- Слайдеров добавлено: 3
- Слайдеров удалено: 2
- Параметров в defaults: +3, -2

### Критерии успеха (все ?)
- [x] bore_head_slider удалён из _create_cylinder_group()
- [x] bore_rod_slider удалён из _create_cylinder_group()
- [x] cyl_diam_m_slider добавлен (единицы м, шаг 0.001, decimals 3)
- [x] stroke_m_slider добавлен (единицы м, шаг 0.001, decimals 3)
- [x] dead_gap_m_slider добавлен (единицы м, шаг 0.001, decimals 3)
- [x] _set_default_values() обновлена (cyl_diam_m=0.080, stroke_m=0.300, dead_gap_m=0.005)
- [x] _connect_signals() обновлена (подключены новые слайдеры)
- [x] _on_parameter_changed() обрабатывает новые параметры
- [x] Валидаторы обновлены (проверка cyl_diam > rod_diam)
- [x] test_geometry_ui.py создан и содержит 26 тестов
- [x] Нет ошибок компиляции (get_errors проверка)
- [x] widget_map обновлен (новые слайдеры добавлены)
- [x] Пресеты обновлены (bore_head ? cyl_diam_m)
- [x] geometry_changed emit обновлён (cylDiamM, strokeM, deadGapM)
- [x] _reset_to_defaults обновлён (сброс новых слайдеров)
- [x] _validate_geometry обновлён (валидация с конвертацией м?мм)

### Готовность к МШ-2: ? 100%

---

## ?? СТРУКТУРА АРТЕФАКТОВ

```
reports/
??? ui/
?   ??? audit_pre.md          ? МШ-0
?   ??? MS_0_COMPLETE.md      ? МШ-0
?   ??? MS_0_FINAL_STATUS.md  ? МШ-0
?   ??? MS_1_COMPLETE.md      ?? МШ-1
?   ??? MS_2_COMPLETE.md      ?? МШ-2
?   ??? ...
?   ??? audit_post.md         ?? МШ-8
?   ??? FINAL_SUMMARY.md      ?? МШ-8
??? tests/
?   ??? smoke_test_results.xml    ?? Каждый МШ
?   ??? ui_tests_results.xml      ?? Каждый МШ
?   ??? ...
??? feedback/
    ??? CONTROL_PLAN.md       ? МШ-0 (этот файл)
    ??? FEEDBACK_README.md    ? МШ-0

artifacts/
??? ui/
    ??? tree_pre.txt          ? МШ-0
    ??? widget_tree_pre.json  ?? МШ-0 (не создан)
    ??? tree_post.txt         ?? МШ-8
    ??? widget_tree_post.json ?? МШ-8
    ??? diff_prompt_all.patch ?? МШ-8
    ??? ui_state.json         ?? МШ-6

logs/
??? ui/
?   ??? ui_params.log         ?? МШ-6
?   ??? ...
??? tests/
    ??? test_smoke.log        ?? Каждый МШ
    ??? test_ui.log           ?? Каждый МШ
    ??? ...
```

---

## ?? ТЕСТЫ

### Smoke Tests (каждый МШ)
- `tests/smoke/test_env_build_qml.py` ? Существует
  - Проверка окружения
  - Проверка импортов
  - Проверка QML offscreen

### UI Tests (каждый МШ)
- `tests/ui/test_geometry_ui.py` ?? МШ-1 (будет создан)
- `tests/ui/test_steps_units.py` ?? МШ-2
- `tests/ui/test_layout_splitters.py` ?? МШ-3
- `tests/ui/test_tabs_scroll_ru.py` ?? МШ-4
- `tests/ui/test_pneumo_ui.py` ?? МШ-5
- `tests/ui/test_signals_logging.py` ?? МШ-6
- `tests/ui/test_final_ui_sweep.py` ?? МШ-7

---

## ?? ОБРАТНАЯ СВЯЗЬ

### Где искать?
- **МШ-отчёты:** `reports/ui/MS_*_COMPLETE.md`
- **Логи:** `logs/ui/`, `logs/tests/`
- **Инструкции:** `reports/feedback/FEEDBACK_README.md`

### Как дать обратную связь?
1. Проверить `reports/ui/MS_*_COMPLETE.md`
2. Проверить логи `logs/`
3. Создать issue с указанием МШ, файла, строки

---

## ?? КРИТЕРИИ ФИНАЛЬНОГО УСПЕХА

### Обязательные изменения
- [ ] Все линейные параметры в м (не мм)
- [ ] Шаг 0.001 м для всех линейных
- [ ] Decimals 3 для всех линейных
- [ ] Единый диаметр цилиндра (не раздельные)
- [ ] Ход поршня, мёртвый зазор добавлены
- [ ] Горизонтальный сплиттер добавлен
- [ ] Пневмо-тумблеры добавлены
- [ ] Логирование UI-изменений работает
- [ ] Все тесты проходят (smoke + UI)

---

**Последнее обновление:** 2025-01-27 16:30
**Следующий шаг:** МШ-3 (Горизонтальный сплиттер)
**Ожидаемое время:** 25-30 минут
**Готовность:** ? 100%

?? **ГОТОВ К СТАРТУ МШ-3!**
