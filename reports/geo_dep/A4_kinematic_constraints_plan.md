# A-4. КИНЕМАТИЧЕСКИЕ ОГРАНИЧЕНИЯ - ПЛАН РЕАЛИЗАЦИИ

## ?? Цель A-4

Реализовать **детальные кинематические ограничения** для геометрии подвески, которые были отложены в A-3. Это включает:

1. **Расчёт максимального хода поршня** (stroke_max)
2. **Кинематические связи** между параметрами подвески  
3. **Автоматическую коррекцию** при нарушении кинематических ограничений
4. **Физически корректные пределы** для всех геометрических параметров

---

## ?? Анализ проблемы

### Что было в A-3:
- Простое заглушка: `stroke_max = cylinder_length - piston_thickness_m - 2*dead_gap_m`
- Кинематические ограничения упоминались, но не реализовывались детально

### Что нужно в A-4:
- **Реальные кинематические расчёты** на основе геометрии рычагов
- **Связь stroke_max с lever_geometry** и wheelbase
- **Ограничения углов поворота** рычагов
- **Проверка пересечений** элементов подвески

---

## ?? Кинематическая модель

### Основные параметры подвески:
```
wheelbase (м)           - колёсная база автомобиля
lever_geometry (м)      - расстояние от оси поворота до шарнира цилиндра
stroke (м)              - текущий ход поршня  
stroke_max (м)          - максимально допустимый ход
```

### Кинематические связи:
1. **Геометрия треугольника**: рычаг - цилиндр - шасси
2. **Угловые ограничения**: рычаг не может поворачиваться более чем на ±X градусов
3. **Пространственные ограничения**: цилиндр не должен пересекаться с другими элементами

---

## ??? План реализации A-4

### A-4.1: Анализ текущего состояния
- Проверка существующего GeometryState
- Анализ текущих вычислений stroke_max
- Определение недостающих кинематических параметров

### A-4.2: Математическая модель
- Реализация точных кинематических формул
- Расчёт stroke_max через геометрию рычагов
- Учёт угловых ограничений и пересечений

### A-4.3: Интеграция с GeometryState
- Обновление normalize() с кинематическими проверками
- Добавление кинематических инвариантов
- Автоматическая коррекция при нарушениях

### A-4.4: Тестирование и валидация
- Тесты кинематических расчётов
- Проверка граничных случаев
- Валидация с реальными данными подвески

---

## ?? Технические детали

### Новые методы в GeometryState:
```python
def calculate_stroke_max_kinematic(self) -> float:
    """Точный расчёт максимального хода через кинематику"""
    
def validate_kinematic_constraints(self) -> List[str]:
    """Проверка всех кинематических ограничений"""
    
def apply_kinematic_corrections(self) -> Dict[str, float]:
    """Автоматическая коррекция нарушений кинематики"""
```

### Кинематические инварианты:
1. **Stroke ? stroke_max_kinematic** (основное ограничение)
2. **Lever angle ? max_lever_angle** (угловые ограничения)  
3. **Cylinder clearance ? min_clearance** (пространственные ограничения)
4. **Geometric consistency** (самосогласованность параметров)

---

## ?? Ожидаемые результаты A-4

### ? После завершения A-4:
- Физически корректные кинематические ограничения
- Автоматическая коррекция невозможных конфигураций
- Точные расчёты максимального хода поршня
- Полная интеграция с существующей системой нормализации

### ?? Готовность к использованию:
- Инженеры смогут задавать реалистичные параметры подвески
- Система предотвратит физически невозможные конфигурации
- Автоматические подсказки по оптимальным параметрам

---

**Статус**: ?? Готов к началу A-4.1  
**Приоритет**: Высокий (завершает базовую геометрическую модель)  
**Сложность**: Средняя (требует математических расчётов)