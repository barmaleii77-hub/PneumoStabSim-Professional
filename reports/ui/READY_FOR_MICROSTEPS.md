# ?? ГОТОВНОСТЬ К МИКРОШАГАМ ПРИЕМКИ

**Дата:** 2025-10-06 13:26:00
**Статус:** ? ПРОЕКТ ГОТОВ К ВЫПОЛНЕНИЮ МИКРОШАГОВ ПРИЕМКИ

## ?? Выполненная подготовка

### ? Инструменты созданы
- **Пред-аудит:** `tools/pre_audit.py` - полноценная диагностика
- **Smoke-тесты:** `tests/smoke/test_env_build_qml.py` - проверка окружения
- **Система трассировки:** интеграция с `tools/feedback/feedback.py`
- **Отчетность:** структурированные MD/JSON отчеты

### ? Диагностика выполнена
- **Окружение:** Python 3.13.7 + PySide6 6.9.3 ?
- **Структура:** 6/6 директорий + 7/8 ключевых файлов ?
- **UI базис:** вкладки, сплиттеры, прокрутка ?
- **Тесты:** UI/геометрия/smoke структура ?

### ? Проблемы выявлены
- **Кодировка:** 3 файла с проблемами UTF-8 (подлежат исправлению)
- **Отсутствующие файлы:** `src/ui/geo_state_new.py` (проверить необходимость)
- **Приемка A/B:** содержимое требует верификации по чек-листам

## ?? ГОТОВЫЕ МИКРОШАГИ

### MS-A-ACCEPT — Приемка геометрии (Часть A)
**Цель:** Верификация унификации 5 параметров цилиндра + СИ единицы
- ? **Файлы:** `panel_geometry.py`, `geo_state.py` (исправить кодировку)
- ? **Чек-лист:** cyl_diam_m, rod_diam_m, stroke_m, piston_thickness_m, dead_gap_m
- ? **Единицы:** метры, шаг 0.001, decimals=3
- ? **Валидация:** rod < cyl - 0.004, stroke ? stroke_max
- ? **Тесты:** smoke + UI-геометрия + unit-нормализация + integration

### MS-B-ACCEPT — Приемка ресивера (Часть B)
**Цель:** Верификация режимов R1/R2 + численные эталоны
- ? **Файлы:** `receiver.py`, `panel_pneumo.py` (исправить кодировку)
- ? **Режимы:** R1 (Freeze P/T), R2 (пересчет изотерма/адиабата)
- ? **Эталоны:** проверка на P?=2.0 бар, V?=20л, ?=1.4
- ? **UI:** переключатель режимов + поле объема + кнопка "Применить"
- ? **Тесты:** smoke + UI-структура + unit-R1/R2 + integration

### MS-C — Горизонтальный сплиттер
**Цель:** Центральный контейнер ? горизонтальный QSplitter
- ? **Структура:** слева (вертик. сплиттер сцена/графики) ? справа (вкладки)
- ? **Имена:** split_main_h, split_main_v
- ? **Настройки:** сохранение/восстановление через QSettings
- ? **Тесты:** наличие сплиттеров + реальный ресайз + графики на всю ширину

### MS-D — Пневмо-панель тумблеры
**Цель:** Добавление системных переключателей
- ? **Элементы:** "Стабилизатор ВКЛ/ВЫКЛ", "Использовать ресивер"
- ? **Сигналы:** UI-флаги + обработчики в главном окне
- ? **Логирование:** изменения состояний
- ? **Тесты:** наличие элементов + сигналы + лог-строки

## ?? КРИТЕРИИ ПРИЕМКИ

### Smoke-тесты (обязательно в каждом микрошаге)
- ? **Сборка:** Python/OS/PySide6/Qt/QtQuick3D версии
- ? **Пути:** src/, assets/qml/, tests/ существуют
- ? **Компиляция:** py_compile всех .py
- ? **QML:** загрузка в offscreen (QT_QPAA_PLATFORM=offscreen)

### UI-структура
- ? **Вкладки:** присутствуют, подписи на русском
- ? **Прокрутка:** QScrollArea в каждой вкладке
- ? **Графики:** снизу на всю ширину (вертикальный сплиттер)
- ? **C/D:** горизонтальный сплиттер (левая область ? вкладки)

### Отчетность
- ? **Формат:** JUnit/XML/JSON/MD в reports/tests/
- ? **Логи:** stdout/stderr в logs/tests/
- ? **Трассировка:** JSONL в logs/<area>/run_<id>.jsonl
- ? **Артефакты:** патчи, дампы, деревья в artifacts/<area>/

## ? ПЛАН ВЫПОЛНЕНИЯ

1. **MS-A-ACCEPT** (?3 файла, ?200 строк)
   - Исправить кодировку panel_geometry.py
   - Запустить чек-листы A-геометрии
   - Прогон всех тестов + отчеты

2. **MS-B-ACCEPT** (?3 файла, ?200 строк)
   - Исправить кодировку receiver.py, panel_pneumo.py
   - Проверить эталоны R1/R2 режимов
   - Прогон всех тестов + отчеты

3. **MS-C** (?3 файла, ?200 строк)
   - Реструктуризация main_window.py
   - QSplitter горизонтальный + QSettings
   - Тесты UI-структуры

4. **MS-D** (?3 файла, ?200 строк)
   - Расширение panel_pneumo.py
   - Обработчики в main_window.py
   - Тесты элементов + сигналов

---

## ?? ЗАКЛЮЧЕНИЕ

**Пред-аудит полностью выполнен.** Проект готов к микрошагам приемки и доработок согласно промту.

Все инструменты созданы, проблемы выявлены, план сформирован. Каждый микрошаг четко определен с критериями приемки ?3 файла, ?200 строк дифф.

**Следующий шаг:** MS-A-ACCEPT — Приемка геометрии
