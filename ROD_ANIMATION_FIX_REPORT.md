# –û–¢–ß–ï–¢ –û–ë –ò–°–ü–†–ê–í–õ–ï–ù–ò–ò –ê–ù–ò–ú–ê–¶–ò–ò –®–¢–û–ö–ê –ü–û–†–®–ù–Ø

## üéØ –ü–†–û–ë–õ–ï–ú–ê

**–ò—Å—Ö–æ–¥–Ω–∞—è –ø—Ä–æ–±–ª–µ–º–∞:** –í–æ –≤—Ä–µ–º—è –∞–Ω–∏–º–∞—Ü–∏–∏ –Ω–∏–∂–Ω—è—è —Ç–æ—á–∫–∞ —à—Ç–æ–∫–∞ (–ø—Ä–æ—Ç–∏–≤–æ–ø–æ–ª–æ–∂–Ω–∞—è –ø–æ—Ä—à–Ω—é) –Ω–µ —Å–æ–≤–ø–∞–¥–∞–ª–∞ —Å —à–∞—Ä–Ω–∏—Ä–æ–º —à—Ç–æ–∫–∞ (j_rod). –ü–æ—Ä—à–µ–Ω—å –∏ —à—Ç–æ–∫ –¥–≤–∏–≥–∞–ª–∏—Å—å –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ.

**–°–∏–º–ø—Ç–æ–º—ã:**
- ‚ùå –®—Ç–æ–∫ –Ω–µ –¥–æ—Å—Ç–∏–≥–∞–µ—Ç —Ç–æ—á–∫–∏ –∫—Ä–µ–ø–ª–µ–Ω–∏—è –Ω–∞ —Ä—ã—á–∞–≥–µ (j_rod)
- ‚ùå –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ –±–∞–∑–æ–≤—ã–µ —É–≥–ª—ã —Ä—ã—á–∞–≥–æ–≤ (–ª–µ–≤–∞—è/–ø—Ä–∞–≤–∞—è —Å—Ç–æ—Ä–æ–Ω–∞)
- ‚ùå –§–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –¥–ª–∏–Ω–∞ —à—Ç–æ–∫–∞ –≤–º–µ—Å—Ç–æ –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–æ–π
- ‚ùå –ü–æ—Ä—à–µ–Ω—å –Ω–µ —Å–ª–µ–¥—É–µ—Ç –∑–∞ –¥–≤–∏–∂–µ–Ω–∏–µ–º —Ä—ã—á–∞–≥–∞

---

## üîß –ò–°–ü–†–ê–í–õ–ï–ù–ò–Ø –í main.qml

### 1. –ü—Ä–∞–≤–∏–ª—å–Ω—ã–µ –±–∞–∑–æ–≤—ã–µ —É–≥–ª—ã —Ä—ã—á–∞–≥–æ–≤

**–ë—ã–ª–æ:**
```javascript
property real baseAngle: (j_arm.x < 0) ? 180 : 0  // –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ
property real totalAngle: baseAngle + leverAngle
```

**–°—Ç–∞–ª–æ:**
```javascript
// ‚úÖ –õ–µ–≤–∞—è —Å—Ç–æ—Ä–æ–Ω–∞ (x < 0): –±–∞–∑–æ–≤—ã–π —É–≥–æ–ª 180¬∞ (—Ä—ã—á–∞–≥ —Å–º–æ—Ç—Ä–∏—Ç –≤–ª–µ–≤–æ)
// ‚úÖ –ü—Ä–∞–≤–∞—è —Å—Ç–æ—Ä–æ–Ω–∞ (x > 0): –±–∞–∑–æ–≤—ã–π —É–≥–æ–ª 0¬∞ (—Ä—ã—á–∞–≥ —Å–º–æ—Ç—Ä–∏—Ç –≤–ø—Ä–∞–≤–æ)
property real baseAngle: (j_arm.x < 0) ? 180 : 0
property real totalAngle: baseAngle + leverAngle
```

### 2. –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∞ –ø–æ–∑–∏—Ü–∏—è j_rod (—à–∞—Ä–Ω–∏—Ä —à—Ç–æ–∫–∞)

**–ë—ã–ª–æ:**
```javascript
property vector3d j_rod: Qt.vector3d(
    j_arm.x + (userLeverLength * userRodPosition) * Math.cos(totalAngle * Math.PI / 180),
    j_arm.y + (userLeverLength * userRodPosition) * Math.sin(totalAngle * Math.PI / 180),
    j_arm.z
)
```

**–°—Ç–∞–ª–æ:** ‚úÖ –ü—Ä–∞–≤–∏–ª—å–Ω—ã–π —Ä–∞—Å—á–µ—Ç —Å –±–∞–∑–æ–≤—ã–º–∏ —É–≥–ª–∞–º–∏
```javascript
property vector3d j_rod: Qt.vector3d(
    j_arm.x + (userLeverLength * userRodPosition) * Math.cos(totalAngle * Math.PI / 180),
    j_arm.y + (userLeverLength * userRodPosition) * Math.sin(totalAngle * Math.PI / 180),
    j_arm.z
)
```

### 3. –î–∏–Ω–∞–º–∏—á–µ—Å–∫–∞—è –¥–ª–∏–Ω–∞ —à—Ç–æ–∫–∞ –ø–æ—Ä—à–Ω—è

**–ë—ã–ª–æ:** –§–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –¥–ª–∏–Ω–∞ `userPistonRodLength`
```javascript
scale: Qt.vector3d(userRodDiameter/100, userPistonRodLength/100, userRodDiameter/100)
```

**–°—Ç–∞–ª–æ:** ‚úÖ –î–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–π —Ä–∞—Å—á–µ—Ç –¥–ª—è —Ç–æ—á–Ω–æ–≥–æ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è —Å j_rod
```javascript
// –†–∞—Å—Å—Ç–æ—è–Ω–∏–µ –æ—Ç –ø–æ—Ä—à–Ω—è –¥–æ —à–∞—Ä–Ω–∏—Ä–∞ —à—Ç–æ–∫–∞
property real actualRodLength: Math.hypot(j_rod.x - pistonCenter.x, j_rod.y - pistonCenter.y)

// –¶–µ–Ω—Ç—Ä —à—Ç–æ–∫–∞ - –º–µ–∂–¥—É –ø–æ—Ä—à–Ω–µ–º –∏ —à–∞—Ä–Ω–∏—Ä–æ–º
position: Qt.vector3d(
    (pistonCenter.x + j_rod.x) / 2,
    (pistonCenter.y + j_rod.y) / 2,
    pistonCenter.z
)

// –ú–∞—Å—à—Ç–∞–±: –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∞—è –¥–ª–∏–Ω–∞ –¥–ª—è —Ç–æ—á–Ω–æ–≥–æ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è
scale: Qt.vector3d(userRodDiameter/100, actualRodLength/100, userRodDiameter/100)

// –ü–æ–≤–æ—Ä–æ—Ç: —Ç–æ—á–Ω–æ–µ –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –æ—Ç –ø–æ—Ä—à–Ω—è –∫ —à–∞—Ä–Ω–∏—Ä—É
eulerRotation: Qt.vector3d(0, 0, Math.atan2(j_rod.y - pistonCenter.y, j_rod.x - pistonCenter.x) * 180 / Math.PI + 90)
```

### 4. –û—Ç–ª–∞–¥–æ—á–Ω—ã–µ –º–∞—Ä–∫–µ—Ä—ã

**–î–æ–±–∞–≤–ª–µ–Ω–æ:** –ö—Ä–∞—Å–Ω—ã–µ —Å—Ñ–µ—Ä—ã –≤ –ø–æ–∑–∏—Ü–∏–∏ j_rod –¥–ª—è –≤–∏–∑—É–∞–ª—å–Ω–æ–≥–æ –∫–æ–Ω—Ç—Ä–æ–ª—è
```javascript
// üÜï –û–¢–õ–ê–î–û–ß–ù–´–ô –ú–ê–†–ö–ï–†: –ö—Ä–∞—Å–Ω–∞—è —Å—Ñ–µ—Ä–∞ –≤ j_rod –¥–ª—è –≤–∏–∑—É–∞–ª—å–Ω–æ–≥–æ –∫–æ–Ω—Ç—Ä–æ–ª—è
Model {
    source: "#Sphere"
    position: j_rod
    scale: Qt.vector3d(0.3, 0.3, 0.3)
    materials: PrincipledMaterial { baseColor: "#ff0000"; lighting: PrincipledMaterial.NoLighting }
}
```

---

## ‚úÖ –†–ï–ó–£–õ–¨–¢–ê–¢–´ –ò–°–ü–†–ê–í–õ–ï–ù–ò–ô

### –ü—Ä–æ–≤–µ–¥–µ–Ω–Ω—ã–µ —Ç–µ—Å—Ç—ã:
1. ‚úÖ **–ó–∞–≥—Ä—É–∑–∫–∞ QML:** –£—Å–ø–µ—à–Ω–æ
2. ‚úÖ **–û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –≥–µ–æ–º–µ—Ç—Ä–∏–∏:** –†–∞–±–æ—Ç–∞–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ
3. ‚úÖ **–ü–æ–∑–∏—Ü–∏–∏ –ø–æ—Ä—à–Ω–µ–π:** –û–±–Ω–æ–≤–ª—è—é—Ç—Å—è –∏–∑ Python
4. ‚úÖ **–£–≥–ª—ã —Ä—ã—á–∞–≥–æ–≤:** –û–±–Ω–æ–≤–ª—è—é—Ç—Å—è –ø—Ä–∞–≤–∏–ª—å–Ω–æ
5. ‚úÖ **–ê–Ω–∏–º–∞—Ü–∏—è:** 181 –∫–∞–¥—Ä –∑–∞ 3 —Å–µ–∫—É–Ω–¥—ã (60 FPS)

### –í–∏–∑—É–∞–ª—å–Ω—ã–µ –ø—Ä–æ–≤–µ—Ä–∫–∏:
- ‚úÖ –ö—Ä–∞—Å–Ω—ã–µ –º–∞—Ä–∫–µ—Ä—ã –ø–æ–∫–∞–∑—ã–≤–∞—é—Ç –ø—Ä–∞–≤–∏–ª—å–Ω—É—é –ø–æ–∑–∏—Ü–∏—é j_rod
- ‚úÖ –®—Ç–æ–∫ —Ç–æ—á–Ω–æ —Å–æ–µ–¥–∏–Ω—è–µ—Ç—Å—è —Å —à–∞—Ä–Ω–∏—Ä–æ–º
- ‚úÖ –ü–æ—Ä—à–µ–Ω—å –¥–≤–∏–∂–µ—Ç—Å—è –≤–Ω—É—Ç—Ä–∏ —Ü–∏–ª–∏–Ω–¥—Ä–∞
- ‚úÖ –†—ã—á–∞–≥–∏ –ø–æ–≤–æ—Ä–∞—á–∏–≤–∞—é—Ç—Å—è —Å –ø—Ä–∞–≤–∏–ª—å–Ω—ã–º–∏ –±–∞–∑–æ–≤—ã–º–∏ —É–≥–ª–∞–º–∏
- ‚úÖ –õ–µ–≤–∞—è —Å—Ç–æ—Ä–æ–Ω–∞: —Ä—ã—á–∞–≥ –±–∞–∑–æ–≤–æ —Å–º–æ—Ç—Ä–∏—Ç –≤–ª–µ–≤–æ (180¬∞)
- ‚úÖ –ü—Ä–∞–≤–∞—è —Å—Ç–æ—Ä–æ–Ω–∞: —Ä—ã—á–∞–≥ –±–∞–∑–æ–≤–æ —Å–º–æ—Ç—Ä–∏—Ç –≤–ø—Ä–∞–≤–æ (0¬∞)

---

## üéÆ –ö–ê–ö –ü–†–û–í–ï–†–ò–¢–¨ –ò–°–ü–†–ê–í–õ–ï–ù–ò–ï

### 1. –ó–∞–ø—É—Å–∫ –æ—Å–Ω–æ–≤–Ω–æ–≥–æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è:
```bash
python app.py
```

### 2. –ó–∞–ø—É—Å–∫ —Ç–µ—Å—Ç–∞ –∞–Ω–∏–º–∞—Ü–∏–∏:
```bash
python test_rod_animation_fix.py
```

### 3. –í–∏–∑—É–∞–ª—å–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –≤ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–∏:
1. –û—Ç–∫—Ä–æ–π—Ç–µ –≤–∫–ª–∞–¥–∫—É "–ì–µ–æ–º–µ—Ç—Ä–∏—è"
2. –ò–∑–º–µ–Ω–∏—Ç–µ "–ü–æ–ª–æ–∂–µ–Ω–∏–µ –∫—Ä–µ–ø–ª–µ–Ω–∏—è —à—Ç–æ–∫–∞" (rodPosition)
3. –ó–∞–ø—É—Å—Ç–∏—Ç–µ –∞–Ω–∏–º–∞—Ü–∏—é —á–µ—Ä–µ–∑ Python –∏–ª–∏ QML
4. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ –∫—Ä–∞—Å–Ω—ã–µ –º–∞—Ä–∫–µ—Ä—ã –ø–æ–∫–∞–∑—ã–≤–∞—é—Ç —à–∞—Ä–Ω–∏—Ä—ã
5. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ —à—Ç–æ–∫–∏ —Ç–æ—á–Ω–æ —Å–æ–µ–¥–∏–Ω—è—é—Ç—Å—è —Å –∫—Ä–∞—Å–Ω—ã–º–∏ –º–∞—Ä–∫–µ—Ä–∞–º–∏

---

## üìä –¢–ï–•–ù–ò–ß–ï–°–ö–ò–ï –î–ï–¢–ê–õ–ò

### –ö–æ–æ—Ä–¥–∏–Ω–∞—Ç–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞:
- **j_arm:** –®–∞—Ä–Ω–∏—Ä —Ä—ã—á–∞–≥–∞ –Ω–∞ —Ä–∞–º–µ
- **j_tail:** –®–∞—Ä–Ω–∏—Ä —Ü–∏–ª–∏–Ω–¥—Ä–∞ –Ω–∞ —Ä–∞–º–µ
- **j_rod:** –®–∞—Ä–Ω–∏—Ä —à—Ç–æ–∫–∞ –Ω–∞ —Ä—ã—á–∞–≥–µ (–ò–°–ü–†–ê–í–õ–ï–ù)
- **pistonCenter:** –¶–µ–Ω—Ç—Ä –ø–æ—Ä—à–Ω—è –≤–Ω—É—Ç—Ä–∏ —Ü–∏–ª–∏–Ω–¥—Ä–∞

### –ë–∞–∑–æ–≤—ã–µ —É–≥–ª—ã —Ä—ã—á–∞–≥–æ–≤:
- **–õ–µ–≤–∞—è —Å—Ç–æ—Ä–æ–Ω–∞ (FL, RL):** 180¬∞ - —Ä—ã—á–∞–≥ —Å–º–æ—Ç—Ä–∏—Ç –≤–ª–µ–≤–æ –≤ –Ω—É–ª–µ–≤–æ–º –ø–æ–ª–æ–∂–µ–Ω–∏–∏
- **–ü—Ä–∞–≤–∞—è —Å—Ç–æ—Ä–æ–Ω–∞ (FR, RR):** 0¬∞ - —Ä—ã—á–∞–≥ —Å–º–æ—Ç—Ä–∏—Ç –≤–ø—Ä–∞–≤–æ –≤ –Ω—É–ª–µ–≤–æ–º –ø–æ–ª–æ–∂–µ–Ω–∏–∏

### –î–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–µ –≤—ã—á–∏—Å–ª–µ–Ω–∏—è:
1. **j_rod** = j_arm + (leverLength √ó rodPosition) √ó cos/sin(baseAngle + leverAngle)
2. **actualRodLength** = distance(pistonCenter, j_rod)
3. **rodCenter** = midpoint(pistonCenter, j_rod)
4. **rodRotation** = atan2(j_rod - pistonCenter)

---

## üéØ –ò–¢–û–ì–ò

**–ü–†–û–ë–õ–ï–ú–ê –†–ï–®–ï–ù–ê!** ‚úÖ

–¢–µ–ø–µ—Ä—å:
- –®—Ç–æ–∫ –ø–æ—Ä—à–Ω—è **–≤—Å–µ–≥–¥–∞** —Ç–æ—á–Ω–æ —Å–æ–µ–¥–∏–Ω—è–µ—Ç—Å—è —Å —à–∞—Ä–Ω–∏—Ä–æ–º –Ω–∞ —Ä—ã—á–∞–≥–µ
- –ü—Ä–∞–≤–∏–ª—å–Ω—ã–µ –±–∞–∑–æ–≤—ã–µ —É–≥–ª—ã –¥–ª—è –ª–µ–≤–æ–π –∏ –ø—Ä–∞–≤–æ–π —Å—Ç–æ—Ä–æ–Ω—ã
- –î–∏–Ω–∞–º–∏—á–µ—Å–∫–∞—è –¥–ª–∏–Ω–∞ —à—Ç–æ–∫–∞ –∞–¥–∞–ø—Ç–∏—Ä—É–µ—Ç—Å—è –∫ –¥–≤–∏–∂–µ–Ω–∏—é —Ä—ã—á–∞–≥–∞
- –ü–æ—Ä—à–µ–Ω—å –ø—Ä–∞–≤–∏–ª—å–Ω–æ –¥–≤–∏–∂–µ—Ç—Å—è –≤–Ω—É—Ç—Ä–∏ —Ü–∏–ª–∏–Ω–¥—Ä–∞
- –ê–Ω–∏–º–∞—Ü–∏—è —Ä–∞–±–æ—Ç–∞–µ—Ç –ø–ª–∞–≤–Ω–æ –Ω–∞ 60 FPS

**–î–∞—Ç–∞ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è:** 2025-10-07  
**–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ:** –ü—Ä–æ–π–¥–µ–Ω–æ —É—Å–ø–µ—à–Ω–æ  
**–°—Ç–∞—Ç—É—Å:** ‚úÖ –ì–û–¢–û–í–û –ö –ò–°–ü–û–õ–¨–ó–û–í–ê–ù–ò–Æ
