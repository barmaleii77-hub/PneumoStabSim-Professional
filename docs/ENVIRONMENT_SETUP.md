# ENVIRONMENT_SETUP.md ‚Äî Qt –∏ Python –æ–∫—Ä—É–∂–µ–Ω–∏–µ

–î–æ–∫—É–º–µ–Ω—Ç –æ–±—ä–µ–¥–∏–Ω—è–µ—Ç —Å–≤–µ–¥–µ–Ω–∏—è, –∫–æ—Ç–æ—Ä—ã–µ —Ä–∞–Ω—å—à–µ –±—ã–ª–∏ —Ä–∞–∑–±—Ä–æ—Å–∞–Ω—ã –ø–æ `docs/run.md`,
`.github/copilot-instructions.md`, `docs/TROUBLESHOOTING.md` –∏ –æ—Ç—á—ë—Ç–∞–º –æ–±
–æ–∫—Ä—É–∂–µ–Ω–∏–∏. –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –µ–≥–æ –∫–∞–∫ –µ–¥–∏–Ω—É—é —Ç–æ—á–∫—É –ø—Ä–∞–≤–¥—ã –ø—Ä–∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–µ —Ä–∞–±–æ—á–∏—Ö –∏
headless-–ø—Ä–æ—Ñ–∏–ª–µ–π.

> –ù–æ–≤–æ–µ: —Å–º. —Ç–∞–∫–∂–µ `docs/CLI.md` ‚Äî —Ä–∞–∑–ª–∏—á–∏—è –º–µ–∂–¥—É `--no-qml`, `--safe` –∏ `--legacy`.

## 0. –ü–æ—à–∞–≥–æ–≤–∞—è —É—Å—Ç–∞–Ω–æ–≤–∫–∞ –æ–∫—Ä—É–∂–µ–Ω–∏—è

### Linux (Ubuntu 22.04+/headless –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä—ã)

1. **–°–∏—Å—Ç–µ–º–Ω—ã–µ –ø–∞–∫–µ—Ç—ã Qt/X11/GL** ‚Äî —Ç–æ –∂–µ, —á—Ç–æ –≤ CI/Docker. –ú–æ–∂–Ω–æ –≤—Ä—É—á–Ω—É—é –∏–ª–∏
   –¥–æ–≤–µ—Ä–∏—Ç—å—Å—è `setup_linux.sh` (–æ–Ω –≤—ã–ø–æ–ª–Ω–∏—Ç –∫–æ–º–∞–Ω–¥—ã —Å–∞–º) –∏ –ø–æ—Å—Ç–∞–≤–∏—Ç Xvfb+
   Mesa –¥–ª—è —Å–æ—Ñ—Ç–≤–µ—Ä–Ω–æ–≥–æ GL **–∏** –±–∏–Ω–∞—Ä–Ω—ã–µ Qt-—à—Ç—É–∫–∏ (`qmlimportscanner`,
   Shader Baker):

   ```sh
   sudo apt-get update
   sudo apt-get install -y --no-install-recommends \
     build-essential git curl pkg-config \
     xvfb xauth dbus-x11 \
     mesa-utils mesa-utils-extra libgl1 libgl1-mesa-dri libglu1-mesa libglu1-mesa-dev \
     libegl1 libegl1-mesa-dev libgles2-mesa-dev libosmesa6 libosmesa6-dev libgbm1 libdrm2 \
     libxcb-xinerama0 libxkbcommon0 libxkbcommon-x11-0 \
     libxcb-keysyms1 libxcb-image0 libxcb-icccm4 libxcb-render-util0 libxcb-xfixes0 libxcb-shape0 libxcb-randr0 libxcb-glx0 \
     libvulkan1 mesa-vulkan-drivers vulkan-tools qt6-base-dev qt6-base-dev-tools qt6-shader-baker
   ```

   Mesa + OSMesa –¥–∞—é—Ç –ø—Ä–æ–≥—Ä–∞–º–º–Ω—ã–π OpenGL, Qt dev-–ø–∞–∫–µ—Ç—ã –≤–∫–ª—é—á–∞—é—Ç `qmlimportscanner`
   –∏ Shader Baker, Xvfb/X11 –ø–∞–∫–µ—Ç—ã –ø–æ–∫—Ä—ã–≤–∞—é—Ç headless-–∑–∞–ø—É—Å–∫–∏ QtQuick3D. –î–ª—è
   –º–∞—à–∏–Ω —Å GPU –¥–æ–±–∞–≤—å—Ç–µ `nvidia-driver-535`/`mesa-vulkan-drivers` (—É–∂–µ –≤ —Å–ø–∏—Å–∫–µ)
   –∏ –ø—Ä–æ–≤–µ—Ä—å—Ç–µ ICD-—Ñ–∞–π–ª—ã (`ls /usr/share/vulkan/icd.d/`).

2. **–ê–≤—Ç–æ–Ω–∞—Å—Ç—Ä–æ–π–∫–∞ –æ–∫—Ä—É–∂–µ–Ω–∏—è** ‚Äî —Å—Ç–∞–≤–∏—Ç Python-–∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ (—á–µ—Ä–µ–∑ `uv` –∏–ª–∏ pip),
   `aqtinstall`, PySide6/QtQuick3D, headless-–ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ (`QT_QPA_PLATFORM=offscreen`,
   `QT_OPENGL=desktop`, `QT_QUICK_BACKEND=software`, `QSG_RHI_BACKEND=opengl`).
   –í CI Qt –∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è –æ—Ç–¥–µ–ª—å–Ω—ã–º —à–∞–≥–æ–º, –ø–æ—ç—Ç–æ–º—É –æ–±—ã—á–Ω–æ –∏—Å–ø–æ–ª—å–∑—É–µ–º `--skip-qt`:

   ```sh
   ./scripts/setup_linux.sh --qt-version 6.10.0 --skip-qt
   ```

   –î–ª—è –ª–æ–∫–∞–ª—å–Ω–æ–π –∑–∞–≥—Ä—É–∑–∫–∏ Qt —É–±–µ—Ä–∏—Ç–µ —Ñ–ª–∞–≥. `--skip-system` –∏ `--skip-python`
   –ø—Ä–∏–≥–æ–¥—è—Ç—Å—è –ø—Ä–∏ –ø–æ–≤—Ç–æ—Ä–Ω—ã—Ö –ø—Ä–æ–≥–æ–Ω–∞—Ö –≤ —É–∂–µ –ø–æ–¥–≥–æ—Ç–æ–≤–ª–µ–Ω–Ω–æ–º –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–µ.

3. **Xvfb –∏ DISPLAY** ‚Äî –µ—Å–ª–∏ –Ω—É–∂–µ–Ω —Ä–µ–∞–ª—å–Ω—ã–π `DISPLAY`, –ø–æ–¥–Ω–∏–º–∏—Ç–µ Xvfb **–¥–æ**
   –≤—ã–∑–æ–≤–∞ —Å–∫—Ä–∏–ø—Ç–∞, —á—Ç–æ–±—ã –ø–µ—Ä–µ–º–µ–Ω–Ω–∞—è –ø–æ–ø–∞–ª–∞ –≤ —ç–∫—Å–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã–π env. –ë–µ–∑ Xvfb
   `DISPLAY` –æ—Å—Ç–∞—ë—Ç—Å—è –ø—É—Å—Ç—ã–º –∏ Qt —É—Ö–æ–¥–∏—Ç –≤ offscreen. –°–∫—Ä–∏–ø—Ç —Ñ–∏–∫—Å–∏—Ä—É–µ—Ç —Ç–µ–∫—É—â–µ–µ
   –∑–Ω–∞—á–µ–Ω–∏–µ `DISPLAY` –≤ `$GITHUB_ENV`/–ª–æ–∫–∞–ª—å–Ω–æ–º env –∏ —Å–æ–æ–±—â–∞–µ—Ç, –∏—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –ª–∏
   offscreen. –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–æ–≥—Ä–∞–º–º–Ω–æ–≥–æ GL:

   ```sh
   Xvfb :99 -screen 0 1920x1080x24 &
   export DISPLAY=:99
   ./scripts/setup_linux.sh --qt-version 6.10.0 --skip-system --skip-qt
   xvfb-run --auto-servernum glxinfo | grep "OpenGL version"
   ```

4. **–¢–µ—Å—Ç—ã –±–µ–∑ —Ä—É—á–Ω—ã—Ö —à–∞–≥–æ–≤** ‚Äî –ø—Ä–æ–≤–µ—Ä–∫–∞ –º–∏–Ω–∏–º–∞–ª—å–Ω–æ–π —Ü–µ–ø–æ—á–∫–∏: `./scripts/setup_linux.sh && pytest`.
   –ü–æ–ª–Ω—ã–π –ø—Ä–æ—Ñ–∏–ª—å: `make full_verify` –∏–ª–∏ `python -m tools.testing_entrypoint`.
   –°–∫—Ä–∏–ø—Ç –¥–æ–±–∞–≤–ª—è–µ—Ç `QT_PLUGIN_PATH` –∏ `QML2_IMPORT_PATH` –≤ `$GITHUB_ENV`, —Ç–∞–∫
   —á—Ç–æ `pytest -q` –ø–æ–ª—É—á–∞–µ—Ç –ø–æ–ª–Ω–æ—Ü–µ–Ω–Ω—ã–π runtime –¥–∞–∂–µ –±–µ–∑ —à–∞–≥–æ–≤ ¬´Export Qt paths¬ª.

### Windows 10+/Windows Server 2022

1. **–†–∞–∑—Ä–µ—à–∏—Ç—å –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ —Å–∫—Ä–∏–ø—Ç–æ–≤** (–∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä):

   ```powershell
   Set-ExecutionPolicy RemoteSigned -Scope Process -Force
   ```

2. **–î—Ä–∞–π–≤–µ—Ä—ã –∏ —Å–∏—Å—Ç–µ–º–Ω—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã –¥–ª—è Qt RHI/DirectX** ‚Äî –≤ CI —Å—Ç–∞–≤—è—Ç—Å—è —á–µ—Ä–µ–∑
   `setup_windows.ps1`, —Å–ø–∏—Å–æ–∫ –¥–ª—è —Ä—É—á–Ω–æ–π –ø—Ä–æ–≤–µ—Ä–∫–∏ runner'–æ–≤:

   ```powershell
   choco install directx --no-progress -y
   choco install vcredist140 --no-progress -y
   ```

   –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ —É–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ GPU-–¥—Ä–∞–π–≤–µ—Ä—ã –∞–∫—Ç—É–∞–ª—å–Ω—ã –∏ `dxdiag /whql:off`
   –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –≤–∫–ª—é—á—ë–Ω–Ω—ã–µ **DirectX Features**; Qt —Ç–æ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç backend `d3d11`.
   –í headless/CI —Ä–µ–∂–∏–º–µ —Å–∫—Ä–∏–ø—Ç –≤–∫–ª—é—á–∞–µ—Ç `QT_QPA_PLATFORM=offscreen`,
   `QT_QUICK_BACKEND=rhi`, `QSG_RHI_BACKEND=d3d11` –∏ –¥–æ–±–∞–≤–ª—è–µ—Ç –ø—É—Ç–∏ –¥–æ Qt
   –≤ `$GITHUB_ENV`.

3. **–ê–≤—Ç–æ–Ω–∞—Å—Ç—Ä–æ–π–∫–∞ –æ–∫—Ä—É–∂–µ–Ω–∏—è** ‚Äî —Å—Ç–∞–≤–∏—Ç Python-–∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ (`uv`/pip), PySide6,
   `pytest-qt`, headless-–Ω–∞—Å—Ç—Ä–æ–π–∫–∏ (`QT_QPA_PLATFORM=offscreen`,
   `QSG_RHI_BACKEND=d3d11`, `QT_OPENGL=software`, —Å—Ç–∏–ª—å Fusion –∏ HiDPI) –∏ –ø—Ä–∏
   –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ—Å—Ç–∏ —Å–∫–∞—á–∏–≤–∞–µ—Ç Qt —á–µ—Ä–µ–∑ `tools/setup_qt.py`:

   ```powershell
   powershell -File scripts/setup_windows.ps1 -QtVersion 6.10.0 -PythonPath C:\\hostedtoolcache\\windows\\Python\\3.13\\x64\\python.exe -SkipQt:$true
   ```

   –°–Ω–∏–º–∏—Ç–µ `-SkipQt` –¥–ª—è –ª–æ–∫–∞–ª—å–Ω–æ–π –æ—Ñ–ª–∞–π–Ω–æ–≤–æ–π —É—Å—Ç–∞–Ω–æ–≤–∫–∏ Qt. –§–ª–∞–≥–∏ `-SkipUvSync`
   –∏ `-SkipSystem` –ø—Ä–æ–ø—É—Å–∫–∞—é—Ç —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É—é—â–∏–µ —Å—Ç–∞–¥–∏–∏, –µ—Å–ª–∏ runner —É–∂–µ –ø–æ–¥–≥–æ—Ç–æ–≤–ª–µ–Ω.

4. **Smoke-—Ç–µ—Å—Ç—ã** ‚Äî —É–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ `QT_QPA_PLATFORM=offscreen` –∏
   `QSG_RHI_BACKEND=d3d11` –∞–∫—Ç–∏–≤–Ω—ã (—Å–∫—Ä–∏–ø—Ç –≤—ã—Å—Ç–∞–≤–ª—è–µ—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏). –î–∞–ª–µ–µ:
   `pytest` –¥–ª—è –±—ã—Å—Ç—Ä–æ–π –ø—Ä–æ–≤–µ—Ä–∫–∏ –∏–ª–∏ `make full_verify` –¥–ª—è –ø–æ–ª–Ω–æ–≥–æ –ø—Ä–æ–≥–æ–Ω–∞.

## 1. –ü–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ–º—ã–µ –ø—Ä–æ—Ñ–∏–ª–∏ Python/Qt

| –ü—Ä–æ—Ñ–∏–ª—å | –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ | Python | PySide6/QtQuick3D | NumPy | SciPy | –ü—Ä–∏–º–µ—á–∞–Ω–∏—è |
| --- | --- | --- | --- | --- | --- | --- |
| **–û—Å–Ω–æ–≤–Ω–æ–π** | –ï–∂–µ–¥–Ω–µ–≤–Ω–∞—è —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∞, CI | 3.13.x | 6.10.0 | 2.0.1 | 1.13.1 | –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è `make uv-sync` –∏ `python tools/setup_qt.py --qt-version 6.10.0`. |
| **LTS** | –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –ø—Ä–µ–∂–Ω–∏—Ö –∏–Ω—Å—Ç–∞–ª–ª—è—Ü–∏–π | 3.11.x | 6.5.3 | 1.24.4 | 1.11.4 | –¢—Ä–µ–±—É–µ—Ç extras-–ø—Ä–æ—Ñ–∏–ª—è `pneumostabsim[qt65]`. |
| **Legacy** | –†—É—á–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –º–∏–≥—Ä–∞—Ü–∏–π | 3.12.x | 6.8.1 | 1.26.4 | 1.12.0 | –ù–µ –≤—Ö–æ–¥–∏—Ç –≤ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–π `uv`-–ø—Ä–æ—Ñ–∏–ª—å, —Å–æ–∑–¥–∞—ë—Ç—Å—è –≤—Ä—É—á–Ω—É—é. |

> üí° –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ –∫–æ–º–±–∏–Ω–∞—Ü–∏–∏ (PySide6 6.6/6.7/6.9) –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞—é—Ç—Å—è –≤ —Ä–µ–∂–∏–º–µ
> best-effort. –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–π—Ç–µ –∏—Ö —á–µ—Ä–µ–∑ extras (`.[qt66]`, `.[qt69]`) –∏ —Ñ–∏–∫—Å–∏—Ä—É–π—Ç–µ
> —Ä–µ–∑—É–ª—å—Ç–∞—Ç –≤ `reports/quality/environment_setup_report.md`.

## 2. –ë–∞–∑–æ–≤—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è Qt

–≠—Ç–∏ –∑–Ω–∞—á–µ–Ω–∏—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø—Ä–æ—Å—Ç–∞–≤–ª—è—é—Ç—Å—è `src/bootstrap/environment.py` –∏
–ø—Ä–æ–ø–∏—Å—ã–≤–∞—é—Ç—Å—è –≤ `env.sample`. –ü—Ä–∏ —Ä—É—á–Ω–æ–º –∑–∞–ø—É—Å–∫–µ —É–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –æ–Ω–∏ –∑–∞–≥—Ä—É–∂–µ–Ω—ã:

| –ü–µ—Ä–µ–º–µ–Ω–Ω–∞—è | –ó–Ω–∞—á–µ–Ω–∏–µ | –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ |
| --- | --- | --- |
| `QSG_RHI_BACKEND` | `opengl` (Linux/macOS), `d3d11` (Windows) | Backend —Ä–µ–Ω–¥–µ—Ä–∏–Ω–≥–∞ Qt RHI. –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç—Å—è —Å–∫—Ä–∏–ø—Ç–∞–º–∏ –∏ –≤ CI. |
| `QT_QUICK_BACKEND` | `software` (Linux), `rhi` (Windows) | –ö–æ–Ω—Ç—Ä–æ–ª–∏—Ä—É–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ RHI/—Å–æ—Ñ—Ç–≤–µ—Ä–Ω–æ–≥–æ backend. |
| `QT_QUICK_CONTROLS_STYLE` | `Fusion` | –°–æ–≥–ª–∞—Å–æ–≤–∞–Ω–Ω—ã–π —Å—Ç–∏–ª—å –∫–æ–Ω—Ç—Ä–æ–ª–æ–≤ –≤–µ–∑–¥–µ. |
| `QSG_OPENGL_VERSION` | `3.3` | –ú–∏–Ω–∏–º–∞–ª—å–Ω–∞—è –≤–µ—Ä—Å–∏—è OpenGL. |
| `QT_OPENGL` | `desktop` (Linux), `software` (Windows headless) | –ü—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ desktop/ANGLE OpenGL. |
| `QSG_INFO` | `0` | –û—Ç—Å–µ—á–∫–∞ —à—É–º–Ω—ã—Ö –ª–æ–≥–æ–≤ —Å—Ü–µ–Ω—ã. |
| `QT_LOGGING_RULES` | `*.debug=false;qt.scenegraph.general=false` | –ì–ª–æ–±–∞–ª—å–Ω–æ–µ —Å–Ω–∏–∂–µ–Ω–∏–µ —É—Ä–æ–≤–Ω—è –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è Qt/SceneGraph. |
| `QT_AUTO_SCREEN_SCALE_FACTOR` | `1` | –ö–æ—Ä—Ä–µ–∫—Ç–Ω–æ–µ –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ HiDPI. |
| `QT_SCALE_FACTOR_ROUNDING_POLICY` | `PassThrough` | –°—Ç–∞–±–∏–ª—å–Ω–æ–µ –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ UI. |
| `QT_ENABLE_HIGHDPI_SCALING` | `1` | –í–∫–ª—é—á–µ–Ω–∏–µ HiDPI. |
| `QT_ASSUME_STDERR_HAS_CONSOLE` | `1` | –ö–æ—Ä—Ä–µ–∫—Ç–Ω–∞—è –º–∞—Ä—à—Ä—É—Ç–∏–∑–∞—Ü–∏—è stderr. |
| `QT_PLUGIN_PATH` | –ü—É—Ç—å –¥–æ `Qt/<ver>/<arch>/plugins` | –î–æ–±–∞–≤–ª—è–µ—Ç—Å—è —Å–∫—Ä–∏–ø—Ç–∞–º–∏ –∏–ª–∏ —à–∞–≥–æ–º ¬´Export Qt paths¬ª –≤ CI. |
| `QML2_IMPORT_PATH` | –ü—É—Ç—å –¥–æ `Qt/<ver>/<arch>/qml` | –û–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç –¥–æ—Å—Ç—É–ø –∫ –º–æ–¥—É–ª—è–º QtQuick3D –≤ —Ç–µ—Å—Ç–∞—Ö. |
| `PSS_HEADLESS` | `1` (Windows) | –£–ø—Ä–æ—â–∞–µ—Ç –≤—ã–±–æ—Ä headless-–Ω–∞—Å—Ç—Ä–æ–µ–∫ –≤ —Ç–µ—Å—Ç–∞—Ö. |
| `PSS_DIAG` | `1` | –í–∫–ª—é—á–µ–Ω–∏–µ –¥–∏–∞–≥–Ω–æ—Å—Ç–∏—á–µ—Å–∫–æ–≥–æ –∫–∞–Ω–∞–ª–∞ —Å–∏–º—É–ª—è—Ç–æ—Ä–∞. |
| `DISPLAY` | –ø—É—Å—Ç–æ (offscreen) –∏–ª–∏ `:99` –ø—Ä–∏ Xvfb | –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ –Ω–∞ Linux. –≠–∫—Å–ø–æ—Ä—Ç–∏—Ä—É–µ—Ç—Å—è –≤—Ä—É—á–Ω—É—é –ø–æ—Å–ª–µ –∑–∞–ø—É—Å–∫–∞ Xvfb. |

> GitHub Actions (`.github/workflows/ci.yml`) –≤—ã–∑—ã–≤–∞–µ—Ç `scripts/setup_linux.sh --skip-qt`
> –∏ `scripts/setup_windows.ps1 -SkipQt:$true`, –∑–∞—Ç–µ–º —à–∞–≥ ¬´Export Qt paths¬ª –∑–∞–ø–∏—Å—ã–≤–∞–µ—Ç
> `QT_PLUGIN_PATH`/`QML2_IMPORT_PATH` –≤ `GITHUB_ENV`, –∞ —à–∞–≥ ¬´Document headless Qt environment¬ª
> –ø—É–±–ª–∏–∫—É–µ—Ç –≤ summary –∞–∫—Ç–∏–≤–Ω—ã–µ `QT_QPA_PLATFORM`, `QSG_RHI_BACKEND`, `QT_OPENGL`, `DISPLAY`
> –∏ –ø—É—Ç–∏ –¥–æ Qt. –ü—Ä–∏ –ª–æ–∫–∞–ª—å–Ω–æ–π —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–µ –ø—Ä–∏–¥–µ—Ä–∂–∏–≤–∞–π—Ç–µ—Å—å —Ç–µ—Ö –∂–µ –∑–Ω–∞—á–µ–Ω–∏–π, —á—Ç–æ–±—ã
> –∏—Å–∫–ª—é—á–∏—Ç—å —Ä–∞—Å—Ö–æ–∂–¥–µ–Ω–∏—è –º–µ–∂–¥—É CI –∏ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–æ–º.

## 3. Headless –∏ Vulkan —Å—Ü–µ–Ω–∞—Ä–∏–∏

| –°—Ü–µ–Ω–∞—Ä–∏–π | –û–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ | –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —à–∞–≥–∏ |
| --- | --- | --- |
| **Linux headless (CI, –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä)** | `QT_QPA_PLATFORM=offscreen`, `QT_QUICK_BACKEND=software`, `LIBGL_ALWAYS_SOFTWARE=1` | –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ `DISPLAY` –Ω–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω. –ö–æ–º–∞–Ω–¥–∞ `make uv-run CMD="pytest -q"` –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø—Ä–∏–º–µ–Ω–∏—Ç –ø—Ä–æ—Ñ–∏–ª—å. –ó–∞–ø—É—Å–∫–∞–π—Ç–µ `./setup_linux.sh` –¥–ª—è —É—Å—Ç–∞–Ω–æ–≤–∫–∏ `libGL`, `libxkbcommon`, `qt6-shader-baker` –∏ Python-–∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π PySide6/QtQuick3D –ø–µ—Ä–µ–¥ –ø—Ä–æ–≥–æ–Ω–æ–º —Ç–µ—Å—Ç–æ–≤. |
| **Vulkan smoke** | `QSG_RHI_BACKEND=vulkan`, `VK_ICD_FILENAMES=/usr/share/vulkan/icd.d/lvp_icd.x86_64.json` | –ü—É—Ç—å –∫ ICD –ø—Ä–æ–≤–µ—Ä—å—Ç–µ `ls /usr/share/vulkan/icd.d/`. –î–ª—è headless –¥–æ–±–∞–≤—å—Ç–µ `QT_QPA_PLATFORM=offscreen`. |
| **Windows ANGLE fallback** | `QT_QPA_PLATFORM=windows`, `QT_OPENGL=angle` | –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –ø—Ä–∏ –ø—Ä–æ–±–ª–µ–º–∞—Ö —Å –¥—Ä–∞–π–≤–µ—Ä–∞–º–∏ OpenGL. –í–æ–∑–≤—Ä–∞—â–∞—è—Å—å –∫ GPU, —É–¥–∞–ª–∏—Ç–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –∏–ª–∏ –∑–∞–¥–∞–π—Ç–µ `QT_OPENGL=desktop`. |
| **Safe mode (software-only)** | `LIBGL_ALWAYS_SOFTWARE=1`, `QT_QUICK_BACKEND=software` | –í Python –º–æ–∂–Ω–æ –≤—ã–∑–≤–∞—Ç—å `configure_qt_environment(safe_mode=True)`; –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –ø–æ–¥—Ö–≤–∞—Ç—è—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏. |

## 4. –ü—Ä–æ–≤–µ—Ä–∫–∞ –æ–∫—Ä—É–∂–µ–Ω–∏—è

1. `make uv-sync` –∏–ª–∏ `python -m tools.task_runner uv-sync` ‚Äî —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è
   –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π.
2. `python tools/setup_qt.py --qt-version 6.10.0` ‚Äî —É—Å—Ç–∞–Ω–æ–≤–∫–∞ Qt Quick 3D.
3. `make check` ‚Äî –∞–≥—Ä–µ–≥–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ (`ruff`, `mypy`, `pytest`, `qmllint`).
4. `python -m tools.environment.verify_qt_setup --expected-version 6.10` ‚Äî
   —É–±–µ–¥–∏—Ç—å—Å—è, —á—Ç–æ PySide6 –Ω–∞–π–¥–µ–Ω –∏ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤—É–µ—Ç —Ü–µ–ª–µ–≤–æ–π –≤–µ—Ä—Å–∏–∏.
5. –°–æ—Ö—Ä–∞–Ω–∏—Ç–µ –≤—ã–≤–æ–¥ –≤ `reports/quality/environment_setup_report.md` –ø—Ä–∏ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–∏
   –ø—Ä–æ—Ñ–∏–ª–µ–π.

### –ö—Ä–æ—Å—Å–ø–ª–∞—Ç—Ñ–æ—Ä–º–µ–Ω–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

- Linux/macOS:

  ```sh
  make cross-platform-prep
  make cross-platform-test
  ```

- Windows / —Å—Ä–µ–¥—ã –±–µ–∑ `make`:

  ```powershell
  python -m tools.task_runner cross-platform-prep -- --qt-version 6.10.0
  python -m tools.task_runner cross-platform-test -- --pytest-args tests
  ```

–°–∫—Ä–∏–ø—Ç `tools/cross_platform_test_prep.py` –ø—Ä–æ–≤–µ—Ä—è–µ—Ç –Ω–∞–ª–∏—á–∏–µ —Å–∏—Å—Ç–µ–º–Ω—ã—Ö –ø–∞–∫–µ—Ç–æ–≤,
–∏–º–ø–æ—Ä—Ç PySide6/`pytest-qt` –∏ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –≤–∫–ª—é—á–∞–µ—Ç headless-–Ω–∞—Å—Ç—Ä–æ–π–∫–∏ Qt
(`QT_QPA_PLATFORM=offscreen`, `QT_QUICK_BACKEND=software` –¥–ª—è Linux,
`QSG_RHI_BACKEND=d3d11` –¥–ª—è Windows) –ø—Ä–∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–∏ —Å—Ç–∏–ª—è `QT_QUICK_CONTROLS_STYLE=Fusion`
–¥–ª—è –ø–æ–ª–Ω–æ–≥–æ —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–∏—è —Ä–∞–Ω—Ç–∞–π–º—É –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è. –ù–∞ Linux —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç—Å—è –ø–æ–ª–Ω—ã–π
–Ω–∞–±–æ—Ä –±–∏–±–ª–∏–æ—Ç–µ–∫, –∏–¥–µ–Ω—Ç–∏—á–Ω—ã–π Dockerfile (`git`, `curl`, `pkg-config`,
`build-essential`, Mesa/Qt —Å—Ç—ç–∫ `libegl-dev`, `libgles-dev`, `libx11-*`,
`libxcb-*`, `mesa-utils-extra`, `libvulkan1`, `mesa-vulkan-drivers`, `vulkan-tools` –∏ –¥—Ä.),
—á—Ç–æ –∏—Å–∫–ª—é—á–∞–µ—Ç –ø—Ä–æ–ø—É—Å–∫–∏ –¥–∞–∂–µ –¥–ª—è QML/3D —Å—Ü–µ–Ω–∞—Ä–∏–µ–≤. –í—ã–ø–æ–ª–Ω—è–π—Ç–µ —ç—Ç–∏ –∫–æ–º–∞–Ω–¥—ã –ø–æ—Å–ª–µ
**–∫–∞–∂–¥–æ–≥–æ** –∏–∑–º–µ–Ω–µ–Ω–∏—è –∫–æ–¥–∞, —á—Ç–æ–±—ã —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å –ø–∞—Ä–∏—Ç–µ—Ç —Ç–µ—Å—Ç–æ–≤ –º–µ–∂–¥—É –ø–ª–∞—Ç—Ñ–æ—Ä–º–∞–º–∏.
–ü—Ä–æ–≤–µ—Ä–∫–∞ –∏–º–ø–æ—Ä—Ç–æ–≤ –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç —á–µ—Ä–µ–∑ –∏–Ω—Ç–µ—Ä–ø—Ä–µ—Ç–∞—Ç–æ—Ä `.venv`, —Å—Ñ–æ—Ä–º–∏—Ä–æ–≤–∞–Ω–Ω—ã–π `uv`,
–ø–æ—ç—Ç–æ–º—É –∑–∞–ø—É—Å–∫ —Å–∫—Ä–∏–ø—Ç–∞ –∏–∑ —Å–∏—Å—Ç–µ–º–Ω–æ–≥–æ Python –Ω–µ –ø—Ä–∏–≤–æ–¥–∏—Ç –∫ –ª–æ–∂–Ω—ã–º ¬´–æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç
pytest-qt¬ª ‚Äî –ø—Ä–æ–≤–µ—Ä—è–µ—Ç—Å—è –∏–º–µ–Ω–Ω–æ —Ç–æ—Ç –Ω–∞–±–æ—Ä –ø–∞–∫–µ—Ç–æ–≤, –∫–æ—Ç–æ—Ä—ã–π –±—É–¥–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è
–≤ —Ç–µ—Å—Ç–∞—Ö.
–ù–∞—á–∏–Ω–∞—è —Å –≤–µ—Ä—Å–∏–∏ 4.9.8 —Ç–µ—Å—Ç–æ–≤—ã–π —Ä–∞–Ω–Ω–µ—Ä –±–æ–ª—å—à–µ –Ω–µ –ø—Ä–æ–ø—É—Å–∫–∞–µ—Ç GUI/QML-—Ç–µ—Å—Ç—ã –ø—Ä–∏
–æ—Ç—Å—É—Ç—Å—Ç–≤–∏–∏ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π ‚Äî –æ–Ω –∑–∞–≤–µ—Ä—à–∞–µ—Ç –ø—Ä–æ–≥–æ–Ω —Å –æ—à–∏–±–∫–æ–π –∏ –ø—Ä–µ–¥–ª–∞–≥–∞–µ—Ç –ø–æ–≤—Ç–æ—Ä–Ω–æ
–∑–∞–ø—É—Å—Ç–∏—Ç—å `python -m tools.cross_platform_test_prep --use-uv`, –ø–æ—ç—Ç–æ–º—É –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–µ
Qt –∏–ª–∏ `pytest-qt` –Ω–µ–º–µ–¥–ª–µ–Ω–Ω–æ –≤—ã—è–≤–ª—è–µ—Ç—Å—è. –ï—Å–ª–∏ Python-–æ–∫—Ä—É–∂–µ–Ω–∏–µ —Ñ–æ—Ä–º–∏—Ä—É–µ—Ç—Å—è
–≤—Ä—É—á–Ω—É—é, –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ –≤—ã–∑–æ–≤–∏—Ç–µ `./setup_linux.sh` –ª–∏–±–æ `powershell -File scripts/setup_windows.ps1`
–¥–ª—è —É—Å—Ç–∞–Ω–æ–≤–∫–∏ –º–æ–¥—É–ª–µ–π PySide6 (`QtWidgets`, `QtQuick3D`, `QtQml`) –∏ –ø–∞–∫–µ—Ç–∞ Shader
Baker.

## 5. HDR –æ–∫—Ä—É–∂–µ–Ω–∏–µ –∏ —Ç–æ–Ω–µ–º–∞–ø–ø–∏–Ω–≥

- –í—ã–ø–æ–ª–Ω–∏—Ç–µ `python -m tools.render_checks.validate_hdr_orientation` –ø–µ—Ä–µ–¥ —Å–±–æ—Ä–∫–æ–π
  —Ä–µ–ª–∏–∑–Ω—ã—Ö –±–∏–ª–¥–∞–æ–≤. –°–∫—Ä–∏–ø—Ç —Å–≤–µ—Ä—è–µ—Ç `config/baseline/materials.json` –∏ –æ—Ç—á—ë—Ç
  `reports/performance/hdr_orientation.md`, –ø—Ä–æ–≤–µ—Ä—è—è –æ—Ä–∏–µ–Ω—Ç–∞—Ü–∏—é skybox-–æ–≤,
  –¥–æ–ø—É—Å—Ç–∏–º–æ—Å—Ç—å —Å—Ç–∞—Ç—É—Å–æ–≤ –∏ —Å–æ–≤–ø–∞–¥–µ–Ω–∏–µ —Ñ–∞–π–ª–æ–≤; –ª—é–±–æ–µ —Ä–∞—Å—Ö–æ–∂–¥–µ–Ω–∏–µ –ø–æ–º–µ—á–∞–µ—Ç —Å–±–æ—Ä–∫—É
  –∫–∞–∫ –æ—à–∏–±–æ—á–Ω—É—é, –ø–æ—ç—Ç–æ–º—É –æ–±–Ω–æ–≤–ª—è–π—Ç–µ –æ—Ç—á—ë—Ç —Å—Ä–∞–∑—É –ø–æ—Å–ª–µ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –Ω–æ–≤–æ–π HDR-–∫–∞—Ä—Ç—ã.
- HDR-–ø–∞–π–ø–ª–∞–π–Ω –≤–∫–ª—é—á—ë–Ω –≤ —Ä–∞–±–æ—á–∏–µ —Å–±–æ—Ä–∫–∏: –≤–∫–ª–∞–¥–∫–∞ ¬´–û–∫—Ä—É–∂–µ–Ω–∏–µ¬ª –ø–µ—Ä–µ—á–∏—Å–ª—è–µ—Ç
  –æ–±–Ω–∞—Ä—É–∂–µ–Ω–Ω—ã–µ HDR/EXR —Ñ–∞–π–ª—ã –∏–∑ `assets/hdr/`, `assets/hdri/` –∏
  `assets/qml/assets/`, –∞ –≤–∫–ª–∞–¥–∫–∞ ¬´Effects¬ª —É–ø—Ä–∞–≤–ª—è–µ—Ç HDR bloom-–ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏
  (`glowHDRMinimumValue`, `glowHDRMaximumValue`, `glowHDRScale`) —Å –¥–∏–∞–ø–∞–∑–æ–Ω–∞–º–∏
  `0.0‚Äì4.0`, `0.0‚Äì10.0` –∏ `1.0‚Äì5.0` —Å–æ–æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ. –í—Å–µ –∑–Ω–∞—á–µ–Ω–∏—è —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è
  —á–µ—Ä–µ–∑ `SettingsManager` –∏ –≤—ã–≤–æ–¥—è—Ç—Å—è –≤ JSON-–ª–æ–≥–∏ `logs/graphics/session_*.jsonl`.
- –ü—Ä–∏ –¥–æ–±–∞–≤–ª–µ–Ω–∏–∏ HDR/EXR-—Ñ–∞–π–ª–æ–≤ –∑–∞–ø—É—Å—Ç–∏—Ç–µ –º–æ–¥—É–ª—å–Ω—ã–µ –ø—Ä–æ–≤–µ—Ä–∫–∏:
  `python -m pytest tests/unit/ui/test_hdr_discovery.py` –∏
  `python -m pytest tests/unit/ui/test_main_window_hdr_paths.py`. –ü–µ—Ä–≤—ã–π —Ç–µ—Å—Ç
  –≥–∞—Ä–∞–Ω—Ç–∏—Ä—É–µ—Ç, —á—Ç–æ `GraphicsPanel` —Å–∫–∞–Ω–∏—Ä—É–µ—Ç `assets/hdr/`, `assets/hdri/` –∏
  `assets/qml/assets/`, –≤—Ç–æ—Ä–æ–π ‚Äî —á—Ç–æ `normalizeHdrPath` —Å—Ç—Ä–æ–∏—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–π
  —Å–ø–∏—Å–æ–∫ –∫–∞–Ω–¥–∏–¥–∞—Ç–æ–≤ –∏ –≤—ã–¥–∞—ë—Ç –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—è –ø—Ä–∏ –æ—Ç—Å—É—Ç—Å—Ç–≤—É—é—â–∏—Ö —Ñ–∞–π–ª–∞—Ö.
- –ü—Ä–∏ –≤–≤–æ–¥–µ –Ω–æ–≤—ã—Ö –ø—É—Ç–µ–π –∏–ª–∏ –ø—Ä–æ–≤–µ—Ä–∫–µ –∫–ª–∏–µ–Ω—Ç—Å–∫–∏—Ö –ø—Ä–æ—Ñ–∏–ª–µ–π –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ
  –≤—ã–ø–æ–ª–Ω–∏—Ç–µ `make verify hdr-verify`: –ø—Ä–æ–≤–µ—Ä–∫–∞ —Å–≤–µ—Ä–∏—Ç `assets/hdr/hdr_manifest.json`,
  SHA-256 —Ö—ç—à–∏ –∏ –∑–∞–≥–æ–ª–æ–≤–∫–∏ Radiance. –í—Å–µ –ø–æ–ø—ã—Ç–∫–∏ —Ä–∞–∑—Ä–µ—à–µ–Ω–∏—è –ø—É—Ç–µ–π —Ç–∞–∫–∂–µ –ø–∏—à—É—Ç—Å—è –≤
  `logs/ibl/ibl_events.jsonl` —Å–æ —Å—Ç–∞—Ç—É—Å–∞–º–∏ `ok|missing|remote|empty`, –ø–æ—ç—Ç–æ–º—É
  —Ö—Ä–∞–Ω–∏ —ç—Ç–∏ –∂—É—Ä–Ω–∞–ª—ã —Ä—è–¥–æ–º —Å —Ç–µ—Å—Ç–æ–≤—ã–º–∏ –∞—Ä—Ç–µ—Ñ–∞–∫—Ç–∞–º–∏.
- –ü—Ä–∏ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–∏ –ø—Ä–µ—Å–µ—Ç–æ–≤ —Ç–æ–Ω–µ–º–∞–ø–ø–∏–Ω–≥–∞ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä—É–π—Ç–µ –∑–Ω–∞—á–µ–Ω–∏—è —á–µ—Ä–µ–∑ –ø–∞–Ω–µ–ª—å
  `TonemappingPanel`: –ø—Ä–µ—Å–µ—Ç—ã —É–ø—Ä–∞–≤–ª—è—é—Ç `tonemap_mode`, —ç–∫—Å–ø–æ–∑–∏—Ü–∏–µ–π –∏ –±–µ–ª–æ–π
  —Ç–æ—á–∫–æ–π –∏ –ø—Ä–∏–º–µ–Ω—è—é—Ç—Å—è —Å—Ä–∞–∑—É –∫ `SettingsManager`, –ø–æ—ç—Ç–æ–º—É —Å–Ω–∏–º–∞—é—Ç—Å—è —Å–Ω–∞–ø—à–æ—Ç—ã
  HDR-–ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ –±–µ–∑ —Ä–∞—Å—Ö–æ–∂–¥–µ–Ω–∏–π —Å runtime.

## 6. –°–∫—Ä–∏–ø—Ç—ã –ø–æ–¥–≥–æ—Ç–æ–≤–∫–∏ –æ–∫—Ä—É–∂–µ–Ω–∏—è

- `./scripts/setup_linux.sh` ‚Äî –Ω–∞—Å—Ç—Ä–∞–∏–≤–∞–µ—Ç headless Linux-—Å—Ä–µ–¥—É: —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç
  —Å–∏—Å—Ç–µ–º–Ω—ã–µ –ø–∞–∫–µ—Ç—ã (`libGL`, `libxkbcommon`, Xvfb, Mesa, Shader Baker),
  —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä—É–µ—Ç Python-–∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ —á–µ—Ä–µ–∑ `uv` (–ª–∏–±–æ `pip`) –∏ —ç–∫—Å–ø–æ—Ä—Ç–∏—Ä—É–µ—Ç
  headless-–ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ `QT_QPA_PLATFORM=offscreen`, `QT_QUICK_BACKEND=software`,
  `QT_OPENGL=desktop`, `QT_QUICK_CONTROLS_STYLE=Fusion`, HiDPI-–Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –∏
  `QSG_RHI_BACKEND=opengl`. –§–ª–∞–≥–∏ `--skip-system`/`--skip-python` —É—Å–∫–æ—Ä—è—é—Ç
  –ø–æ–≤—Ç–æ—Ä–Ω—ã–µ –ø—Ä–æ–≥–æ–Ω–∫–∏, `--skip-qt` –ø–æ–∑–≤–æ–ª—è–µ—Ç –¥–µ–ª–µ–≥–∏—Ä–æ–≤–∞—Ç—å —Å–∫–∞—á–∏–≤–∞–Ω–∏–µ Qt –æ—Ç–¥–µ–ª—å–Ω–æ–º—É
  —à–∞–≥—É –≤ CI.
- `powershell -File scripts/setup_windows.ps1 -PythonPath <–ø—É—Ç—å –¥–æ python.exe>` ‚Äî
  –≤—ã–ø–æ–ª–Ω—è–µ—Ç `uv sync` (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ –ø—Ä–æ–ø—É—Å–∫–∞–µ—Ç—Å—è `-SkipUvSync`), —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç
  DirectX runtime –∏ VC++ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ —á–µ—Ä–µ–∑ Chocolatey (–æ—Ç–∫–ª—é—á–∞–µ—Ç—Å—è `-SkipSystem`),
  –≥–∞—Ä–∞–Ω—Ç–∏—Ä—É–µ—Ç –Ω–∞–ª–∏—á–∏–µ –∫–æ–ª—ë—Å PySide6/`PyOpenGL`/`pytest-qt` –∏ –∞–∫—Ç–∏–≤–∏—Ä—É–µ—Ç
  headless-–ø—Ä–æ—Ñ–∏–ª—å (`QT_QPA_PLATFORM=offscreen`, `QT_QUICK_BACKEND=rhi`,
  `QT_OPENGL=software`, `QSG_RHI_BACKEND=d3d11`, —Å—Ç–∏–ª—å Fusion, HiDPI –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ).
  –î–æ–±–∞–≤—å—Ç–µ `-SkipQt:$true` –≤ CI, –µ—Å–ª–∏ Qt —Å–∫–∞—á–∏–≤–∞–µ—Ç—Å—è –æ—Ç–¥–µ–ª—å–Ω—ã–º —à–∞–≥–æ–º.

–û–±–∞ —Å–∫—Ä–∏–ø—Ç–∞ –∑–∞–ø–∏—Å—ã–≤–∞—é—Ç –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –≤ `GITHUB_ENV`, –µ—Å–ª–∏ –æ–Ω –æ–ø—Ä–µ–¥–µ–ª—ë–Ω (GitHub
Actions), –∏–ª–∏ –ø—Ä–∏–º–µ–Ω—è—é—Ç –∏—Ö –∫ —Ç–µ–∫—É—â–µ–π —Å–µ—Å—Å–∏–∏.

–û–±–∞ —Å–∫—Ä–∏–ø—Ç–∞ –º–æ–≥—É—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è –∫–∞–∫ –ª–æ–∫–∞–ª—å–Ω–æ, —Ç–∞–∫ –∏ –≤ CI. –û–Ω–∏ –ø—Ä–µ–¥–Ω–∞–∑–Ω–∞—á–µ–Ω—ã
–¥–ª—è —É—Å—Ç—Ä–∞–Ω–µ–Ω–∏—è –ø—Ä–æ–ø—É—Å–∫–æ–≤ —Ç–µ—Å—Ç–æ–≤, —Å–≤—è–∑–∞–Ω–Ω—ã—Ö —Å –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–µ–º –±–∏–±–ª–∏–æ—Ç–µ–∫ Qt/OpenGL.

> ‚õî –õ—é–±–æ–π –ø—Ä–æ–ø—É—â–µ–Ω–Ω—ã–π —Ç–µ—Å—Ç —Ç–µ–ø–µ—Ä—å –∑–∞–≤–µ—Ä—à–∞–µ—Ç —Å–µ—Å—Å–∏—é `pytest` —Å–æ —Å—Ç–∞—Ç—É—Å–æ–º –æ—à–∏–±–∫–∏.
> –î–ª—è –≤—Ä–µ–º–µ–Ω–Ω–æ–≥–æ –æ–±—Ö–æ–¥–∞ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ `--allow-skips` –∏–ª–∏ `PSS_ALLOW_SKIPPED_TESTS=1`,
> –Ω–æ —Å—Ä–∞–∑—É –ø–æ—Å–ª–µ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π –≤–æ–∑–≤—Ä–∞—â–∞–π—Ç–µ—Å—å –∫ —Å—Ç—Ä–æ–≥–æ–º—É —Ä–µ–∂–∏–º—É.

## 5. –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏

- –ü—Ä–∏ –∑–∞–ø—É—Å–∫–µ –∏–∑ VS Code –∏–ª–∏ Copilot GPT —Å–Ω–∞—á–∞–ª–∞ –≤—ã–ø–æ–ª–Ω–∏—Ç–µ `make cipilot-env`,
  –∑–∞—Ç–µ–º –∑–∞–≥—Ä—É–∑–∏—Ç–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –∏–∑ `.env.cipilot` (`source ./.env.cipilot`).
- –î–ª—è headless —Ç–µ—Å—Ç–æ–≤ `pytest` –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Ñ–ª–∞–≥ `--pss-headless` –∏–ª–∏ —ç–∫—Å–ø–æ—Ä—Ç–∏—Ä—É–π—Ç–µ
  `PSS_HEADLESS=1`; –æ–Ω –ø–æ–¥—Ö–≤–∞—Ç–∏—Ç –∑–Ω–∞—á–µ–Ω–∏—è –∏–∑ —Ç–∞–±–ª–∏—Ü—ã –≤—ã—à–µ.
- –ü—Ä–∏ —Å–º–µ–Ω–µ backend (OpenGL ‚Üî Vulkan) –æ—á–∏—â–∞–π—Ç–µ –∫—ç—à Qt (`rm -rf ~/.cache/QtProject`)
  –∏ –ø–µ—Ä–µ–∑–∞–ø—É—Å–∫–∞–π—Ç–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ, —á—Ç–æ–±—ã –∏—Å–∫–ª—é—á–∏—Ç—å –∞—Ä—Ç–µ—Ñ–∞–∫—Ç—ã –ø—Ä–æ—à–ª–æ–π —Å–µ—Å—Å–∏–∏.
- –í—Å–µ–≥–¥–∞ –æ–±–Ω–æ–≤–ª—è–π—Ç–µ —ç—Ç–æ—Ç –¥–æ–∫—É–º–µ–Ω—Ç –ø—Ä–∏ –¥–æ–±–∞–≤–ª–µ–Ω–∏–∏ –Ω–æ–≤—ã—Ö –ø—Ä–æ—Ñ–∏–ª–µ–π –∏–ª–∏ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö;
  –æ—Å—Ç–∞–ª—å–Ω—ã–µ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ –¥–æ–ª–∂–Ω—ã —Å—Å—ã–ª–∞—Ç—å—Å—è –∏–º–µ–Ω–Ω–æ –Ω–∞ –Ω–µ–≥–æ.

## 6. –°–∫—Ä–∏–ø—Ç—ã –±—ã—Å—Ç—Ä–æ–π —É—Å—Ç–∞–Ω–æ–≤–∫–∏ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π

- **Linux**: `sudo ./scripts/setup_linux.sh --qt-version 6.10.0 --skip-qt`

  –ü–æ–ª–Ω–æ—Å—Ç—å—é –ø–æ–≤—Ç–æ—Ä—è–µ—Ç –æ–∫—Ä—É–∂–µ–Ω–∏–µ CI: —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç Qt dev –ø–∞–∫–µ—Ç—ã, Mesa/Xvfb,
  —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä—É–µ—Ç Python-–∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ (`PySide6`, `pytest-qt`, `aqtinstall`),
  —ç–∫—Å–ø–æ—Ä—Ç–∏—Ä—É–µ—Ç headless-–ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ (`QT_QPA_PLATFORM=offscreen`,
  `QT_QUICK_BACKEND=software`, `QT_OPENGL=desktop`, HiDPI –Ω–∞—Å—Ç—Ä–æ–π–∫–∏). –î–ª—è
  –æ—Ñ–ª–∞–π–Ω–æ–≤–æ–π —É—Å—Ç–∞–Ω–æ–≤–∫–∏ Qt —É–±–µ—Ä–∏—Ç–µ `--skip-qt`.

- **Windows**: `pwsh ./scripts/setup_windows.ps1 -QtVersion 6.10.0 -PythonPath <python.exe> -SkipQt:$true`

  –ü—Ä–æ–≤–µ—Ä—è–µ—Ç Chocolatey, —Å—Ç–∞–≤–∏—Ç DirectX runtime –∏ VC++ Redistributable (–µ—Å–ª–∏ –Ω–µ
  –æ—Ç–∫–ª—é—á–µ–Ω–æ `-SkipSystem`), —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä—É–µ—Ç `uv` –æ–∫—Ä—É–∂–µ–Ω–∏–µ –∏ –∫–æ–ª—ë—Å–∞
  `PySide6`/`PyOpenGL`/`pytest-qt`, –Ω–∞—Å—Ç—Ä–∞–∏–≤–∞–µ—Ç headless-–ø—Ä–æ—Ñ–∏–ª—å
  (`QT_QPA_PLATFORM=offscreen`, `QT_QUICK_BACKEND=rhi`, `QSG_RHI_BACKEND=d3d11`,
  HiDPI/—Å—Ç–∏–ª—å Fusion). –î–ª—è —É—Å—Ç–∞–Ω–æ–≤–∫–∏ Qt –∏–∑ `tools/setup_qt.py` —É–±–µ—Ä–∏—Ç–µ —Ñ–ª–∞–≥
  `-SkipQt`.

–û–±–∞ —Å–∫—Ä–∏–ø—Ç–∞ –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –≤ CI-–∫–æ–Ω–≤–µ–π–µ—Ä–∞—Ö –ø–µ—Ä–µ–¥ —Å–±–æ—Ä–∫–æ–π, –ø–æ—ç—Ç–æ–º—É —Ä—É—á–Ω—ã–µ –¥–µ–π—Å—Ç–≤–∏—è
–Ω–µ —Ç—Ä–µ–±—É—é—Ç—Å—è: `./scripts/setup_linux.sh && pytest` –≤ –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–µ –∏
`pwsh ./scripts/setup_windows.ps1; pytest` –Ω–∞ Windows –ø–æ–ª–Ω–æ—Å—Ç—å—é –≥–æ—Ç–æ–≤—è—Ç —Å—Ä–µ–¥—É.
