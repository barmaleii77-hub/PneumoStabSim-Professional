[pytest]
# Pytest configuration

# Minimum version
minversion =7.0

# Test discovery patterns
python_files = test_*.py
python_classes = Test*
python_functions = test_*

# Test paths (cover entire suite; GUI-specific tests self-skip when unavailable)
testpaths = tests

# Output options
# Ранее использовался локальный basetemp (.tmp/pytest), что на Windows приводило к PermissionError
# при попытке удаления каталога плагином pytest-qt. Возвращаемся к стандартному временном каталогу pytest.
addopts =
 -ra
 --strict-markers
 --strict-config
 --showlocals
 --tb=short
 -p no:cacheprovider
 -p pytestqt.plugin

xfail_strict = true

# ``pytestqt`` is optional; ``tests/conftest.py`` registers it when available.
# Importing it unconditionally here breaks lightweight environments used in CI.
# The default PySide6 API is injected through the ``PYTEST_QT_API`` env var once
# the plugin is discovered, keeping headless test runners compatible.

# Coverage options
[coverage:run]
source = src
omit =
 */tests/*
 */conftest.py

[coverage:report]
precision =2
show_missing = True
skip_covered = False

# Markers
markers =
 unit: Unit tests for individual components
 integration: Integration tests for component interactions
 smoke: Minimal health-check scenarios for critical application startup paths
 system: End-to-end system tests
 slow: Tests that take significant time
 gui: Tests requiring GUI/QML
 headless: Tests that explicitly require Qt headless defaults
 scenario: Scenario-driven physics regression suites
 qtbot: Tests exercising Qt widgets with the pytest-qt qtbot fixture
 qt_no_exception_capture: Disable pytest-qt exception capture for targeted tests
 ui: Legacy UI tests (будут объединены с gui позже)
 performance: Performance budgets and timing checks

# Logging
log_cli = false
log_cli_level = INFO
