# –û–¢–ß–ï–¢ –û–ë –ò–°–ü–†–ê–í–õ–ï–ù–ò–ò –î–õ–ò–ù–´ –®–¢–û–ö–ê –ü–û–†–®–ù–Ø

## –ü—Ä–æ–±–ª–µ–º–∞
–ü–æ—Ä—à–µ–Ω—å –¥–≤–∏–≥–∞–ª—Å—è –ø–æ –æ—Å–∏ —Ü–∏–ª–∏–Ω–¥—Ä–∞, –æ—Ç—Å–ª–µ–∂–∏–≤–∞—è –¥–≤–∏–∂–µ–Ω–∏–µ —Ä—ã—á–∞–≥–∞, –Ω–æ **–¥–ª–∏–Ω–∞ —à—Ç–æ–∫–∞ –ø–æ—Ä—à–Ω—è –∏–∑–º–µ–Ω—è–ª–∞—Å—å** –ø—Ä–∏ –¥–≤–∏–∂–µ–Ω–∏–∏ —Ä—ã—á–∞–≥–∞, —Ö–æ—Ç—è –æ–Ω–∞ –¥–æ–ª–∂–Ω–∞ –æ—Å—Ç–∞–≤–∞—Ç—å—Å—è –ø–æ—Å—Ç–æ—è–Ω–Ω–æ–π.

## –ê–Ω–∞–ª–∏–∑ –ø—Ä–æ–±–ª–µ–º—ã
–í –∏—Å—Ö–æ–¥–Ω–æ–º –∫–æ–¥–µ –ª–æ–≥–∏–∫–∞ –±—ã–ª–∞ —Å–ª–µ–¥—É—é—â–µ–π:
1. –ü–æ—Ä—à–µ–Ω—å –ø–æ–∑–∏—Ü–∏–æ–Ω–∏—Ä–æ–≤–∞–ª—Å—è –≤ —Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω–æ–π —Ç–æ—á–∫–µ –Ω–∞ –æ—Å–∏ —Ü–∏–ª–∏–Ω–¥—Ä–∞ (`pistonPositionFromPython`)
2. –®—Ç–æ–∫ —Å–æ–µ–¥–∏–Ω—è–ª –ø–æ—Ä—à–µ–Ω—å —Å —Ç–æ—á–∫–æ–π `j_rod` –Ω–∞ —Ä—ã—á–∞–≥–µ  
3. –ü—Ä–∏ –¥–≤–∏–∂–µ–Ω–∏–∏ —Ä—ã—á–∞–≥–∞ —Ç–æ—á–∫–∞ `j_rod` –∏–∑–º–µ–Ω—è–ª–∞ –ø–æ–ª–æ–∂–µ–Ω–∏–µ
4. **–î–ª–∏–Ω–∞ —à—Ç–æ–∫–∞ –≤—ã—á–∏—Å–ª—è–ª–∞—Å—å –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏** –∫–∞–∫ —Ä–∞—Å—Å—Ç–æ—è–Ω–∏–µ –º–µ–∂–¥—É –ø–æ—Ä—à–Ω–µ–º –∏ `j_rod`
5. –í —Ä–µ–∑—É–ª—å—Ç–∞—Ç–µ –¥–ª–∏–Ω–∞ —à—Ç–æ–∫–∞ –º–µ–Ω—è–ª–∞—Å—å –ø—Ä–∏ –∫–∞–∂–¥–æ–º –¥–≤–∏–∂–µ–Ω–∏–∏ —Ä—ã—á–∞–≥–∞

## –†–µ—à–µ–Ω–∏–µ
–ò–∑–º–µ–Ω–µ–Ω–∞ –ª–æ–≥–∏–∫–∞ –ø–æ–∑–∏—Ü–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏—è –ø–æ—Ä—à–Ω—è –¥–ª—è –æ–±–µ—Å–ø–µ—á–µ–Ω–∏—è **–ø–æ—Å—Ç–æ—è–Ω–Ω–æ–π –¥–ª–∏–Ω—ã —à—Ç–æ–∫–∞**:

### –ù–æ–≤—ã–π –∞–ª–≥–æ—Ä–∏—Ç–º:
1. **–ü—Ä–æ–µ–∫—Ü–∏—è —à–∞—Ä–Ω–∏—Ä–∞ –Ω–∞ –æ—Å—å —Ü–∏–ª–∏–Ω–¥—Ä–∞**: –í—ã—á–∏—Å–ª—è–µ—Ç—Å—è —Ç–æ—á–∫–∞ –Ω–∞ –æ—Å–∏ —Ü–∏–ª–∏–Ω–¥—Ä–∞, –±–ª–∏–∂–∞–π—à–∞—è –∫ `j_rod`
2. **–ü–µ—Ä–ø–µ–Ω–¥–∏–∫—É–ª—è—Ä–Ω–æ–µ —Ä–∞—Å—Å—Ç–æ—è–Ω–∏–µ**: –ò–∑–º–µ—Ä—è–µ—Ç—Å—è —Ä–∞—Å—Å—Ç–æ—è–Ω–∏–µ –æ—Ç `j_rod` –¥–æ –æ—Å–∏ —Ü–∏–ª–∏–Ω–¥—Ä–∞
3. **–¢–µ–æ—Ä–µ–º–∞ –ü–∏—Ñ–∞–≥–æ—Ä–∞**: –†–∞—Å—Å—á–∏—Ç—ã–≤–∞–µ—Ç—Å—è –ø–æ–∑–∏—Ü–∏—è –ø–æ—Ä—à–Ω—è –Ω–∞ –æ—Å–∏ –¥–ª—è –ø–æ—Å—Ç–æ—è–Ω–Ω–æ–π –¥–ª–∏–Ω—ã —à—Ç–æ–∫–∞
4. **–û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ –≥—Ä–∞–Ω–∏—Ü**: –ü–æ—Ä—à–µ–Ω—å –Ω–µ –≤—ã—Ö–æ–¥–∏—Ç –∑–∞ –ø—Ä–µ–¥–µ–ª—ã —Ü–∏–ª–∏–Ω–¥—Ä–∞

### –ú–∞—Ç–µ–º–∞—Ç–∏—á–µ—Å–∫–∞—è —Ñ–æ—Ä–º—É–ª–∞:
```
rod_length¬≤ = perpendicular_distance¬≤ + axial_distance¬≤
axial_distance = ‚àö(rod_length¬≤ - perpendicular_distance¬≤)
piston_position = j_rod_projection - axial_distance
```

## –í–Ω–µ—Å–µ–Ω–Ω—ã–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è

### 1. –û–±–Ω–æ–≤–ª–µ–Ω–Ω–∞—è –ª–æ–≥–∏–∫–∞ –≤ `assets/qml/main.qml`:

```qml
// üîß –ù–û–í–ê–Ø –õ–û–ì–ò–ö–ê: –ü–æ—Ä—à–µ–Ω—å –ø–æ–∑–∏—Ü–∏–æ–Ω–∏—Ä—É–µ—Ç—Å—è —Ç–∞–∫, —á—Ç–æ–±—ã –¥–ª–∏–Ω–∞ —à—Ç–æ–∫–∞ –±—ã–ª–∞ –ø–æ—Å—Ç–æ—è–Ω–Ω–æ–π
property vector3d j_rodToCylStart: Qt.vector3d(j_rod.x - tailRodEnd.x, j_rod.y - tailRodEnd.y, 0)
property real projectionOnCylAxis: j_rodToCylStart.x * cylDirectionNorm.x + j_rodToCylStart.y * cylDirectionNorm.y

// –ü—Ä–æ–µ–∫—Ü–∏—è j_rod –Ω–∞ –æ—Å—å —Ü–∏–ª–∏–Ω–¥—Ä–∞
property vector3d j_rodProjectionOnAxis: Qt.vector3d(
    tailRodEnd.x + cylDirectionNorm.x * projectionOnCylAxis,
    tailRodEnd.y + cylDirectionNorm.y * projectionOnCylAxis,
    tailRodEnd.z
)

// –†–∞—Å—Å—Ç–æ—è–Ω–∏–µ –æ—Ç –ø—Ä–æ–µ–∫—Ü–∏–∏ j_rod –¥–æ —Ä–µ–∞–ª—å–Ω–æ–≥–æ j_rod (–ø–µ—Ä–ø–µ–Ω–¥–∏–∫—É–ª—è—Ä–Ω–æ –æ—Å–∏ —Ü–∏–ª–∏–Ω–¥—Ä–∞)
property real perpendicularDistance: Math.hypot(
    j_rod.x - j_rodProjectionOnAxis.x,
    j_rod.y - j_rodProjectionOnAxis.y
)

// –í—ã—á–∏—Å–ª—è–µ–º –ø–æ–∑–∏—Ü–∏—é –ø–æ—Ä—à–Ω—è –Ω–∞ –æ—Å–∏ —Ü–∏–ª–∏–Ω–¥—Ä–∞ –¥–ª—è –ø–æ—Å—Ç–æ—è–Ω–Ω–æ–π –¥–ª–∏–Ω—ã —à—Ç–æ–∫–∞
property real rodLengthSquared: userPistonRodLength * userPistonRodLength
property real perpDistSquared: perpendicularDistance * perpendicularDistance
property real axialDistanceFromProjection: Math.sqrt(Math.max(0, rodLengthSquared - perpDistSquared))

// –ü–æ–∑–∏—Ü–∏—è –ø–æ—Ä—à–Ω—è –Ω–∞ –æ—Å–∏ —Ü–∏–ª–∏–Ω–¥—Ä–∞ (–Ω–∞–∑–∞–¥ –æ—Ç –ø—Ä–æ–µ–∫—Ü–∏–∏ j_rod)
property real pistonPositionOnAxis: projectionOnCylAxis - axialDistanceFromProjection

// –û–≥—Ä–∞–Ω–∏—á–∏–≤–∞–µ–º –ø–æ–∑–∏—Ü–∏—é –ø–æ—Ä—à–Ω—è –≤ –ø—Ä–µ–¥–µ–ª–∞—Ö —Ü–∏–ª–∏–Ω–¥—Ä–∞
property real clampedPistonPosition: Math.max(10, Math.min(lCylinder - 10, pistonPositionOnAxis))

// PISTON POSITION - –í–´–ß–ò–°–õ–ï–ù–ù–ê–Ø –¥–ª—è –ø–æ—Å—Ç–æ—è–Ω–Ω–æ–π –¥–ª–∏–Ω—ã —à—Ç–æ–∫–∞
property vector3d pistonCenter: Qt.vector3d(
    tailRodEnd.x + cylDirectionNorm.x * clampedPistonPosition,
    tailRodEnd.y + cylDirectionNorm.y * clampedPistonPosition,
    tailRodEnd.z
)
```

### 2. –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–Ω–æ–µ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ —à—Ç–æ–∫–∞:

```qml
// ‚úÖ –ò–°–ü–†–ê–í–õ–ï–ù–û: PISTON ROD - –ü–û–°–¢–û–Ø–ù–ù–ê–Ø –î–õ–ò–ù–ê!
Model {
    source: "#Cylinder"
    
    // –¶–µ–Ω—Ç—Ä —à—Ç–æ–∫–∞ - –º–µ–∂–¥—É –ø–æ—Ä—à–Ω–µ–º –∏ —à–∞—Ä–Ω–∏—Ä–æ–º
    position: Qt.vector3d(
        (pistonCenter.x + j_rod.x) / 2,
        (pistonCenter.y + j_rod.y) / 2,
        pistonCenter.z
    )
    
    // ‚úÖ –§–ò–ö–°–ò–†–û–í–ê–ù–ù–ê–Ø –î–õ–ò–ù–ê –®–¢–û–ö–ê –∏–∑ –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤ UI
    scale: Qt.vector3d(userRodDiameter/100, userPistonRodLength/100, userRodDiameter/100)
    
    // –ü–æ–≤–æ—Ä–æ—Ç: —Ç–æ—á–Ω–æ–µ –Ω–∞–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –æ—Ç –ø–æ—Ä—à–Ω—è –∫ —à–∞—Ä–Ω–∏—Ä—É
    eulerRotation: Qt.vector3d(0, 0, Math.atan2(j_rod.y - pistonCenter.y, j_rod.x - pistonCenter.x) * 180 / Math.PI + 90)
    
    materials: PrincipledMaterial { baseColor: "#cccccc"; metalness: 0.95; roughness: 0.05 }
}
```

### 3. –û—Ç–ª–∞–¥–æ—á–Ω—ã–µ –º–∞—Ä–∫–µ—Ä—ã:

–î–æ–±–∞–≤–ª–µ–Ω—ã –≤–∏–∑—É–∞–ª—å–Ω—ã–µ –ø–æ–º–æ—â–Ω–∏–∫–∏ –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –ø—Ä–∞–≤–∏–ª—å–Ω–æ—Å—Ç–∏ —Ä–∞–±–æ—Ç—ã:
- üî¥ –ö—Ä–∞—Å–Ω–∞—è —Å—Ñ–µ—Ä–∞ –≤ —Ç–æ—á–∫–µ `j_rod` (—à–∞—Ä–Ω–∏—Ä —à—Ç–æ–∫–∞)
- üü° –ñ–µ–ª—Ç–∞—è —Å—Ñ–µ—Ä–∞ –≤ –ø—Ä–æ–µ–∫—Ü–∏–∏ `j_rod` –Ω–∞ –æ—Å—å —Ü–∏–ª–∏–Ω–¥—Ä–∞
- üü¶ –ì–æ–ª—É–±–∞—è –ª–∏–Ω–∏—è - –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è —Ä–µ–∞–ª—å–Ω–æ–π –¥–ª–∏–Ω—ã —à—Ç–æ–∫–∞

### 4. –û—Ç–ª–∞–¥–æ—á–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è:

```qml
// DEBUG: –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ
Component.onCompleted: {
    console.log("üîß –ü–æ–¥–≤–µ—Å–∫–∞ " + (j_arm.x < 0 ? "L" : "R") + ":")
    console.log("   –ó–∞–¥–∞–Ω–Ω–∞—è –¥–ª–∏–Ω–∞ —à—Ç–æ–∫–∞: " + userPistonRodLength.toFixed(1) + "–º–º")
    console.log("   –†–µ–∞–ª—å–Ω–∞—è –¥–ª–∏–Ω–∞ —à—Ç–æ–∫–∞: " + actualRodLength.toFixed(1) + "–º–º")
    console.log("   –û—Ç–∫–ª–æ–Ω–µ–Ω–∏–µ: " + (actualRodLength - userPistonRodLength).toFixed(1) + "–º–º")
    console.log("   –ü–æ–∑–∏—Ü–∏—è –ø–æ—Ä—à–Ω—è –Ω–∞ –æ—Å–∏: " + clampedPistonPosition.toFixed(1) + "–º–º")
}
```

## –†–µ–∑—É–ª—å—Ç–∞—Ç

### –î–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è:
- ‚ùå –î–ª–∏–Ω–∞ —à—Ç–æ–∫–∞ –∏–∑–º–µ–Ω—è–ª–∞—Å—å –ø—Ä–∏ –¥–≤–∏–∂–µ–Ω–∏–∏ —Ä—ã—á–∞–≥–∞
- ‚ùå –®—Ç–æ–∫ —Ä–∞—Å—Ç—è–≥–∏–≤–∞–ª—Å—è –∏ —Å–∂–∏–º–∞–ª—Å—è –Ω–µ—Ñ–∏–∑–∏—á–Ω–æ
- ‚ùå –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ–µ –º–æ–¥–µ–ª–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–Ω–µ–≤–º–æ—Å–∏—Å—Ç–µ–º—ã

### –ü–æ—Å–ª–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è:
- ‚úÖ –î–ª–∏–Ω–∞ —à—Ç–æ–∫–∞ –æ—Å—Ç–∞–µ—Ç—Å—è –ø–æ—Å—Ç–æ—è–Ω–Ω–æ–π (= `userPistonRodLength`)
- ‚úÖ –ü–æ—Ä—à–µ–Ω—å –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ –¥–≤–∏–∂–µ—Ç—Å—è –ø–æ –æ—Å–∏ —Ü–∏–ª–∏–Ω–¥—Ä–∞
- ‚úÖ –ü–æ—Ä—à–µ–Ω—å –æ—Ç—Å–ª–µ–∂–∏–≤–∞–µ—Ç –¥–≤–∏–∂–µ–Ω–∏–µ —Ä—ã—á–∞–≥–∞ —á–µ—Ä–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–µ –ø–æ–ª–æ–∂–µ–Ω–∏—è
- ‚úÖ –§–∏–∑–∏—á–µ—Å–∫–∏ –ø—Ä–∞–≤–∏–ª—å–Ω–æ–µ –º–æ–¥–µ–ª–∏—Ä–æ–≤–∞–Ω–∏–µ –º–µ—Ö–∞–Ω–∏–∑–º–∞

## –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–±–æ—Ç—ã

–î–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è:
1. –ó–∞–ø—É—Å—Ç–∏—Ç—å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ: `python app.py`
2. –í–∫–ª—é—á–∏—Ç—å –∞–Ω–∏–º–∞—Ü–∏—é –≤ –ø–∞–Ω–µ–ª–∏ "–†–µ–∂–∏–º—ã —Å—Ç–∞–±–∏–ª–∏–∑–∞—Ç–æ—Ä–∞"
3. –ù–∞–±–ª—é–¥–∞—Ç—å –¥–≤–∏–∂–µ–Ω–∏–µ –ø–æ—Ä—à–Ω–µ–π - –≥–æ–ª—É–±—ã–µ –ª–∏–Ω–∏–∏ (–≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è —à—Ç–æ–∫–∞) –¥–æ–ª–∂–Ω—ã –∏–º–µ—Ç—å –æ–¥–∏–Ω–∞–∫–æ–≤—É—é –¥–ª–∏–Ω—É –ø—Ä–∏ –ª—é–±—ã—Ö —É–≥–ª–∞—Ö —Ä—ã—á–∞–≥–æ–≤
4. –í –∫–æ–Ω—Å–æ–ª–∏ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å —Å–æ–æ–±—â–µ–Ω–∏—è "–û—Ç–∫–ª–æ–Ω–µ–Ω–∏–µ: X.X –º–º" - –∑–Ω–∞—á–µ–Ω–∏—è –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –±–ª–∏–∑–∫–∏ –∫ 0

## –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

### –ü–∞—Ä–∞–º–µ—Ç—Ä—ã:
- `userPistonRodLength`: –ó–∞–¥–∞–Ω–Ω–∞—è –¥–ª–∏–Ω–∞ —à—Ç–æ–∫–∞ (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é 200–º–º)
- `actualRodLength`: –†–µ–∞–ª—å–Ω–∞—è –≤—ã—á–∏—Å–ª–µ–Ω–Ω–∞—è –¥–ª–∏–Ω–∞ (–¥–ª—è –∫–æ–Ω—Ç—Ä–æ–ª—è)
- `clampedPistonPosition`: –ü–æ–∑–∏—Ü–∏—è –ø–æ—Ä—à–Ω—è –≤ –ø—Ä–µ–¥–µ–ª–∞—Ö —Ü–∏–ª–∏–Ω–¥—Ä–∞

### –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è:
- –ü–æ—Ä—à–µ–Ω—å –Ω–µ –º–æ–∂–µ—Ç –≤—ã–π—Ç–∏ –∑–∞ –≥—Ä–∞–Ω–∏—Ü—ã —Ü–∏–ª–∏–Ω–¥—Ä–∞ (10–º–º...cylLength-10–º–º)
- –ü—Ä–∏ –æ—á–µ–Ω—å –±–æ–ª—å—à–∏—Ö —É–≥–ª–∞—Ö —Ä—ã—á–∞–≥–∞ –≤–æ–∑–º–æ–∂–Ω–æ –¥–æ—Å—Ç–∏–∂–µ–Ω–∏–µ –≥—Ä–∞–Ω–∏—Ü —Ü–∏–ª–∏–Ω–¥—Ä–∞
- –ê–ª–≥–æ—Ä–∏—Ç–º —Ä–∞–±–æ—Ç–∞–µ—Ç –≤ 2D-–ø—Ä–æ–µ–∫—Ü–∏–∏ (XY –ø–ª–æ—Å–∫–æ—Å—Ç—å)

---
**–°—Ç–∞—Ç—É—Å**: ‚úÖ –ò–°–ü–†–ê–í–õ–ï–ù–û  
**–î–∞—Ç–∞**: 2025-01-07  
**–í–µ—Ä—Å–∏—è**: PneumoStabSim 2.0.0
