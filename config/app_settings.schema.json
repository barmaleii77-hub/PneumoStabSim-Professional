{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "title": "Application Settings",
  "type": "object",
  "required": ["current", "defaults_snapshot", "metadata"],
  "additionalProperties": false,
  "properties": {
    "current": { "$ref": "#/$defs/settingsPayload" },
    "defaults_snapshot": { "$ref": "#/$defs/settingsPayload" },
    "metadata": {
      "type": "object",
      "required": ["units_version"],
      "additionalProperties": true,
      "properties": {
        "units_version": { "type": "string" },
        "version": { "type": "string" },
        "last_modified": { "type": "string" },
        "migrated_from": { "type": "string" },
        "migration_date": { "type": "string" },
        "description": { "type": "string" },
        "total_parameters": { "type": "number" },
        "schema_version": { "type": "string" }
      }
    },
    "schemaVersion": { "type": "string" }
  },
  "$defs": {
    "settingsPayload": {
      "type": "object",
      "additionalProperties": true,
      "properties": {
        "geometry": { "$ref": "#/$defs/geometrySettings" },
        "pneumatic": { "$ref": "#/$defs/pneumaticSettings" },
        "simulation": { "$ref": "#/$defs/simulationSettings" },
        "graphics": { "$ref": "#/$defs/graphicsSettings" },
        "modes": { "type": "object", "additionalProperties": true }
      }
    },
    "geometrySettings": {
      "type": "object",
      "additionalProperties": true,
      "properties": {
        "wheelbase": { "type": "number" }
      }
    },
    "pneumaticSettings": {
      "type": "object",
      "additionalProperties": true,
      "properties": {
        "volume_mode": { "type": "string" },
        "receiver_volume": { "type": "number" },
        "receiver_volume_limits": {
          "type": "object",
          "additionalProperties": true,
          "properties": {
            "min_m3": { "type": "number" },
            "max_m3": { "type": "number" }
          }
        },
        "master_isolation_open": { "type": "boolean" },
        "thermo_mode": { "type": "string" }
      }
    },
    "simulationSettings": {
      "type": "object",
      "additionalProperties": true,
      "properties": {
        "physics_dt": { "type": "number" },
        "render_vsync_hz": { "type": "number" },
        "max_steps_per_frame": { "type": "number" },
        "max_frame_time": { "type": "number" }
      }
    },
    "graphicsSettings": {
      "type": "object",
      "additionalProperties": true,
      "properties": {
        "materials": { "type": "object" },
        "environment": { "type": "object" },
        "lighting": { "type": "object" },
        "quality": { "type": "object" },
        "camera": { "type": "object" },
        "effects": { "type": "object" }
      }
    }
  }
}
