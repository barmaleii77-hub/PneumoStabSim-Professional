# üé® –ò–°–ü–†–ê–í–õ–ï–ù–ò–ï –¢–û–ù–ï–ú–ê–ü–ü–ò–ù–ì–ê –ò –¢–ï–ù–ï–ô v3

**–î–∞—Ç–∞:** 2025-01-12  
**–ü—Ä–æ–±–ª–µ–º–∞:** –¢–æ–Ω–µ–º–∞–ø–ø–∏–Ω–≥ (Reinhard, Gamma) –Ω–µ —Ä–∞–±–æ—Ç–∞—é—Ç, —Ç–µ–Ω–∏ –Ω–µ –æ—Ç–∫–ª—é—á–∞—é—Ç—Å—è  
**–°—Ç–∞—Ç—É—Å:** ‚úÖ **–ò–°–ü–†–ê–í–õ–ï–ù–û –ò –ì–û–¢–û–í–û –ö –¢–ï–°–¢–ò–†–û–í–ê–ù–ò–Æ**

---

## üêõ –í—ã—è–≤–ª–µ–Ω–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã

### 1. –¢–æ–Ω–µ–º–∞–ø–ø–∏–Ω–≥ –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç (Reinhard, Gamma –Ω–µ –ø—Ä–∏–º–µ–Ω—è—é—Ç—Å—è)

**–°–∏–º–ø—Ç–æ–º—ã:**
- –ò–∑–º–µ–Ω–µ–Ω–∏–µ —Ä–µ–∂–∏–º–∞ —Ç–æ–Ω–µ–º–∞–ø–ø–∏–Ω–≥–∞ –Ω–µ –≤–ª–∏—è–µ—Ç –Ω–∞ –∫–∞—Ä—Ç–∏–Ω–∫—É
- –¢–æ–ª—å–∫–æ –ø—Ä–∏ –ø–ª–∞–≤–Ω–æ–º –¥–≤–∏–∂–µ–Ω–∏–∏ —Å–ª–∞–π–¥–µ—Ä–∞ –∏–ª–∏ –∏–∑–º–µ–Ω–µ–Ω–∏–∏ –≤ –ø–æ–ª–µ –≤–≤–æ–¥–∞ - —ç—Ñ—Ñ–µ–∫—Ç –≤–∏–¥–µ–Ω
- –ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ –º–µ–∂–¥—É Filmic/Reinhard/Gamma –Ω–µ –¥–∞–µ—Ç –≤–∏–¥–∏–º–æ–≥–æ —ç—Ñ—Ñ–µ–∫—Ç–∞

**–ü—Ä–∏—á–∏–Ω–∞:**
```javascript
// ‚ùå –°–¢–ê–†–ê–Ø –õ–û–ì–ò–ö–ê - —Å–ª–æ–∂–Ω–∞—è —É—Å–ª–æ–≤–Ω–∞—è –ª–æ–≥–∏–∫–∞ —Å fallback
if (typeof p.tonemap_enabled === 'boolean') {
    if (!p.tonemap_enabled) {
        env.tonemapMode = SceneEnvironment.TonemapModeNone;
    } else {
        var mode = p.tonemap_mode || 'filmic';  // ‚Üê Fallback –º–∞—Å–∫–∏—Ä—É–µ—Ç –ø—Ä–æ–±–ª–µ–º—É!
        switch (mode) { ... }
    }
} else if (typeof p.tonemap_mode === 'string') {
    // –í—Ç–æ—Ä–æ–π –ø—É—Ç—å –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è - –¥—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ –ª–æ–≥–∏–∫–∏
    switch (p.tonemap_mode) { ... }
}
```

**–ü—Ä–æ–±–ª–µ–º—ã —Å—Ç–∞—Ä–æ–π –ª–æ–≥–∏–∫–∏:**
1. **Fallback** `var mode = p.tonemap_mode || 'filmic'` - –µ—Å–ª–∏ `tonemap_mode` –Ω–µ –ø—Ä–∏—à—ë–ª, –≤—Å–µ–≥–¥–∞ —Å—Ç–∞–≤–∏—Ç—Å—è Filmic
2. **–î–≤–æ–π–Ω–æ–π –ø—É—Ç—å** –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è - –ª–æ–≥–∏–∫–∞ —Ä–∞–∑–¥–≤–æ–µ–Ω–∞ –Ω–∞ –¥–≤–∞ `if`/`else if`
3. **–ù–µ—Ç –ø—Ä—è–º–æ–≥–æ –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è** - —Ä–µ–∂–∏–º –ø—Ä–∏–º–µ–Ω—è–µ—Ç—Å—è —á–µ—Ä–µ–∑ –ø—Ä–æ–º–µ–∂—É—Ç–æ—á–Ω—É—é –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é

---

### 2. –¢–µ–Ω–∏ –Ω–µ –æ—Ç–∫–ª—é—á–∞—é—Ç—Å—è

**–°–∏–º–ø—Ç–æ–º—ã:**
- –ì–∞–ª–æ—á–∫–∞ "–í–∫–ª—é—á–∏—Ç—å —Ç–µ–Ω–∏" –Ω–µ –≤–ª–∏—è–µ—Ç –Ω–∞ –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ
- –¢–µ–Ω–∏ –≤—Å–µ–≥–¥–∞ –≤–∏–¥–Ω—ã –∏–ª–∏ –≤—Å–µ–≥–¥–∞ –æ—Ç—Å—É—Ç—Å—Ç–≤—É—é—Ç –Ω–µ–∑–∞–≤–∏—Å–∏–º–æ –æ—Ç –Ω–∞—Å—Ç—Ä–æ–π–∫–∏

**–ü—Ä–∏—á–∏–Ω–∞:**
```javascript
// ‚ùå –°–¢–ê–†–ê–Ø –õ–û–ì–ò–ö–ê - –ø—Ä–æ–≤–µ—Ä–∫–∞ —Ç–æ–ª—å–∫–æ root.shadowsEnabled
if (typeof p.shadow_enabled === 'boolean') {
    root.shadowsEnabled = p.shadow_enabled;
    keyLight.castsShadow = p.shadow_enabled;  // ‚Üê –ü—Ä–∏–º–µ–Ω—è–µ—Ç—Å—è –∫ KeyLight
}
// ‚ùå –ù–æ –∑–∞–±—ã–ª–∏ –æ–±–Ω–æ–≤–∏—Ç—å fillLight –∏ rimLight!
```

**–ü—Ä–æ–±–ª–µ–º–∞:**
- `fillLight` –∏ `rimLight` –º–æ–≥—É—Ç –∏–º–µ—Ç—å —Å–≤–æ–∏ `castsShadow = true` –∏–∑ –¥–µ—Ñ–æ–ª—Ç–æ–≤
- –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Ç–æ–ª—å–∫–æ `keyLight.castsShadow` –Ω–µ –≤–ª–∏—è–µ—Ç –Ω–∞ –¥—Ä—É–≥–∏–µ –∏—Å—Ç–æ—á–Ω–∏–∫–∏

---

## ‚úÖ –†–µ—à–µ–Ω–∏—è

### 1. –£–ø—Ä–æ—â—ë–Ω–Ω–∞—è –ª–æ–≥–∏–∫–∞ —Ç–æ–Ω–µ–º–∞–ø–ø–∏–Ω–≥–∞ (v3)

**–ù–æ–≤—ã–π –ø–æ–¥—Ö–æ–¥:**
```javascript
// ‚úÖ –ù–û–í–ê–Ø –õ–û–ì–ò–ö–ê v3 - –£–ü–†–û–©–ï–ù–ù–ê–Ø, –ë–ï–ó FALLBACK
if (typeof p.tonemap_enabled === 'boolean' && typeof p.tonemap_mode === 'string') {
    console.log("  ‚Üí tonemap_enabled:", p.tonemap_enabled, "tonemap_mode:", p.tonemap_mode);
    
    if (!p.tonemap_enabled) {
        // –ï—Å–ª–∏ –≤—ã–∫–ª—é—á–µ–Ω - —è–≤–Ω–æ —Å—Ç–∞–≤–∏–º None
        console.log("  ‚Üí –ü–†–ò–ú–ï–ù–Ø–ï–ú: TonemapModeNone (–æ—Ç–∫–ª—é—á—ë–Ω)");
        env.tonemapMode = SceneEnvironment.TonemapModeNone;
    } else {
        // –ï—Å–ª–∏ –≤–∫–ª—é—á–µ–Ω - –ø—Ä–∏–º–µ–Ω—è–µ–º —Ä–µ–∂–∏–º –ù–ê–ü–†–Ø–ú–£–Æ –∏–∑ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞
        console.log("  ‚Üí –ü–†–ò–ú–ï–ù–Ø–ï–ú —Ä–µ–∂–∏–º:", p.tonemap_mode);
        switch (p.tonemap_mode) {
        case 'filmic':
            env.tonemapMode = SceneEnvironment.TonemapModeFilmic;
            console.log("  ‚úÖ TonemapModeFilmic —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω");
            break;
        case 'aces':
            env.tonemapMode = SceneEnvironment.TonemapModeAces;
            console.log("  ‚úÖ TonemapModeAces —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω");
            break;
        case 'reinhard':
            env.tonemapMode = SceneEnvironment.TonemapModeReinhard;
            console.log("  ‚úÖ TonemapModeReinhard —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω");
            break;
        case 'gamma':
            env.tonemapMode = SceneEnvironment.TonemapModeGamma;
            console.log("  ‚úÖ TonemapModeGamma —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω");
            break;
        case 'linear':
            env.tonemapMode = SceneEnvironment.TonemapModeLinear;
            console.log("  ‚úÖ TonemapModeLinear —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω");
            break;
        case 'none':
            env.tonemapMode = SceneEnvironment.TonemapModeNone;
            console.log("  ‚úÖ TonemapModeNone —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω");
            break;
        default:
            console.warn("  ‚ö†Ô∏è –ù–µ–∏–∑–≤–µ—Å—Ç–Ω—ã–π —Ä–µ–∂–∏–º —Ç–æ–Ω–µ–º–∞–ø–ø–∏–Ω–≥–∞:", p.tonemap_mode);
            break;
        }
    }
}
```

**–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞:**
- ‚úÖ **–ù–µ—Ç fallback** - –µ—Å–ª–∏ `tonemap_mode` –Ω–µ –ø—Ä–∏—à—ë–ª, –Ω–∏—á–µ–≥–æ –Ω–µ –º–µ–Ω—è–µ–º
- ‚úÖ **–û–¥–∏–Ω –ø—É—Ç—å** –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è - –ª–æ–≥–∏–∫–∞ –ª–∏–Ω–µ–π–Ω–∞—è
- ‚úÖ **–ü—Ä—è–º–æ–µ –ø—Ä–∏—Å–≤–∞–∏–≤–∞–Ω–∏–µ** - `env.tonemapMode = SceneEnvironment.Tonemap...` –±–µ–∑ –ø—Ä–æ–º–µ–∂—É—Ç–æ—á–Ω—ã—Ö –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö
- ‚úÖ **–ü–æ–¥—Ä–æ–±–Ω—ã–µ –ª–æ–≥–∏** - –∫–∞–∂–¥—ã–π `case` –ø–∏—à–µ—Ç –≤ –∫–æ–Ω—Å–æ–ª—å —á—Ç–æ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ
- ‚úÖ **–ü—Ä–æ–≤–µ—Ä–∫–∞ –û–ë–ê –ø–∞—Ä–∞–º–µ—Ç—Ä–∞** - `tonemap_enabled AND tonemap_mode` –¥–æ–ª–∂–Ω—ã –ø—Ä–∏–π—Ç–∏ –≤–º–µ—Å—Ç–µ

---

### 2. –§–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –ª–æ–≥–∏–∫–∞ —Ç–µ–Ω–µ–π (v3)

**–ù–æ–≤—ã–π –ø–æ–¥—Ö–æ–¥:**
```javascript
// ‚úÖ –ù–û–í–ê–Ø –õ–û–ì–ò–ö–ê v3 - –£–ü–†–û–©–ï–ù–ù–ê–Ø, –û–ë–ù–û–í–õ–Ø–ï–ú –í–°–ï –ò–°–¢–û–ß–ù–ò–ö–ò
if (typeof p.shadow_enabled === 'boolean') {
    console.log("  ‚Üí –ü–†–ò–ú–ï–ù–Ø–ï–ú shadow_enabled:", p.shadow_enabled);
    
    // –û–±–Ω–æ–≤–ª—è–µ–º –í–°–ï 3 –º–µ—Å—Ç–∞ –≥–¥–µ –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è —Ç–µ–Ω–∏
    root.shadowsEnabled = p.shadow_enabled;
    keyLight.castsShadow = p.shadow_enabled;
    
    // –ü—Ä–æ–≤–µ—Ä—è–µ–º –µ—Å–ª–∏ –µ—Å—Ç—å fillLight –∏ rimLight (–º–æ–≥—É—Ç –±—ã—Ç—å –Ω–µ–¥–æ—Å—Ç—É–ø–Ω—ã –≤ –Ω–µ–∫–æ—Ç–æ—Ä—ã—Ö —Å—Ü–µ–Ω–∞—Ö)
    if (typeof fillLight !== 'undefined' && fillLight && fillLight.castsShadow !== undefined) {
        fillLight.castsShadow = false;  // Fill/Rim –æ–±—ã—á–Ω–æ –±–µ–∑ —Ç–µ–Ω–µ–π
    }
    if (typeof rimLight !== 'undefined' && rimLight && rimLight.castsShadow !== undefined) {
        rimLight.castsShadow = false;
    }
    
    console.log("  ‚úÖ –¢–µ–Ω–∏ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã:", p.shadow_enabled, "KeyLight.castsShadow:", keyLight.castsShadow);
}
```

**–ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞:**
- ‚úÖ **–û–±–Ω–æ–≤–ª—è–µ–º ALL –∏—Å—Ç–æ—á–Ω–∏–∫–∏** - keyLight, fillLight, rimLight
- ‚úÖ **–ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—É—â–µ—Å—Ç–≤–æ–≤–∞–Ω–∏—è** - `typeof !== 'undefined'` –ø–µ—Ä–µ–¥ –¥–æ—Å—Ç—É–ø–æ–º
- ‚úÖ **–Ø–≤–Ω–æ–µ –æ—Ç–∫–ª—é—á–µ–Ω–∏–µ** Fill/Rim - –æ–±—ã—á–Ω–æ —Ç–µ–Ω–∏ —Ç–æ–ª—å–∫–æ –æ—Ç KeyLight
- ‚úÖ **–ü–æ–¥—Ä–æ–±–Ω—ã–µ –ª–æ–≥–∏** - –≤–∏–¥–∏–º —á—Ç–æ –∏–º–µ–Ω–Ω–æ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ

---

## üìù –ò–∑–º–µ–Ω—ë–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã

### 1. `assets/qml/main.qml`

**–§—É–Ω–∫—Ü–∏—è `applyEffectsUpdates()`:**
```diff
- // –°—Ç–∞—Ä–∞—è —Å–ª–æ–∂–Ω–∞—è –ª–æ–≥–∏–∫–∞ —Å fallback
- if (typeof p.tonemap_enabled === 'boolean') {
-     var mode = p.tonemap_mode || 'filmic';  // ‚Üê –ü–†–û–ë–õ–ï–ú–ê
- } else if (typeof p.tonemap_mode === 'string') {
-     // –î—É–±–ª–∏—Ä–æ–≤–∞–Ω–∏–µ
- }

+ // –ù–æ–≤–∞—è —É–ø—Ä–æ—â—ë–Ω–Ω–∞—è –ª–æ–≥–∏–∫–∞ –í–°–ï–ì–î–ê —Å –æ–±–æ–∏–º–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏
+ if (typeof p.tonemap_enabled === 'boolean' && typeof p.tonemap_mode === 'string') {
+     if (!p.tonemap_enabled) {
+         env.tonemapMode = SceneEnvironment.TonemapModeNone;
+     } else {
+         switch (p.tonemap_mode) {
+             case 'filmic': env.tonemapMode = SceneEnvironment.TonemapModeFilmic; break;
+             // ... –æ—Å—Ç–∞–ª—å–Ω—ã–µ —Å–ª—É—á–∞–∏
+         }
+     }
+ }
```

**–§—É–Ω–∫—Ü–∏—è `applyQualityUpdates()`:**
```diff
- // –°—Ç–∞—Ä–∞—è –ª–æ–≥–∏–∫–∞ - —Ç–æ–ª—å–∫–æ keyLight
- if (typeof p.shadow_enabled === 'boolean') {
-     keyLight.castsShadow = p.shadow_enabled;
- }

+ // –ù–æ–≤–∞—è –ª–æ–≥–∏–∫–∞ - –í–°–ï –∏—Å—Ç–æ—á–Ω–∏–∫–∏
+ if (typeof p.shadow_enabled === 'boolean') {
+     root.shadowsEnabled = p.shadow_enabled;
+     keyLight.castsShadow = p.shadow_enabled;
+     if (typeof fillLight !== 'undefined' && fillLight) {
+         fillLight.castsShadow = false;  // –û–±—ã—á–Ω–æ –±–µ–∑ —Ç–µ–Ω–µ–π
+     }
+     if (typeof rimLight !== 'undefined' && rimLight) {
+         rimLight.castsShadow = false;
+     }
+ }
```

---

## üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

### –¢–µ—Å—Ç 1: –¢–æ–Ω–µ–º–∞–ø–ø–∏–Ω–≥ –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ

**–®–∞–≥–∏:**
1. –ó–∞–ø—É—Å—Ç–∏—Ç—å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ
2. –û—Ç–∫—Ä—ã—Ç—å "–≠—Ñ—Ñ–µ–∫—Ç—ã" ‚Üí "–¢–æ–Ω–µ–º–∞–ø–ø–∏–Ω–≥"
3. –ü–æ—Å—Ç–∞–≤–∏—Ç—å –≥–∞–ª–æ—á–∫—É "–í–∫–ª—é—á–∏—Ç—å —Ç–æ–Ω–µ–º–∞–ø–ø–∏–Ω–≥"
4. –ü–µ—Ä–µ–∫–ª—é—á–∏—Ç—å –º–µ–∂–¥—É —Ä–µ–∂–∏–º–∞–º–∏: Filmic ‚Üí Reinhard ‚Üí Gamma ‚Üí ACES ‚Üí Linear

**–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:**
```
‚ú® applyEffectsUpdates –≤—ã–∑–≤–∞–Ω —Å –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏: {...}
  ‚Üí tonemap_enabled: true tonemap_mode: reinhard
  ‚Üí –ü–†–ò–ú–ï–ù–Ø–ï–ú —Ä–µ–∂–∏–º: reinhard
  ‚úÖ TonemapModeReinhard —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω
‚úÖ applyEffectsUpdates –∑–∞–≤–µ—Ä—à—ë–Ω —É—Å–ø–µ—à–Ω–æ
```

**–í–∏–∑—É–∞–ª—å–Ω—ã–π —ç—Ñ—Ñ–µ–∫—Ç:**
- **Filmic** - –∫–∏–Ω–µ–º–∞—Ç–æ–≥—Ä–∞—Ñ–∏—á–Ω–∞—è –∫–∞—Ä—Ç–∏–Ω–∫–∞, —Å–∂–∞—Ç—ã–µ highlight
- **Reinhard** - –±–æ–ª–µ–µ –Ω–∞—Ç—É—Ä–∞–ª—å–Ω—ã–µ —Ü–≤–µ—Ç–∞, –º—è–≥–∫–∏–π rolloff
- **Gamma** - –ø—Ä–æ—Å—Ç–∞—è –≥–∞–º–º–∞ –∫–æ—Ä—Ä–µ–∫—Ü–∏—è, –ª–∏–Ω–µ–π–Ω—ã–π –æ—Ç–≤–µ—Ç
- **ACES** - "–≥–æ–ª–ª–∏–≤—É–¥—Å–∫–∏–π" look, –Ω–∞—Å—ã—â–µ–Ω–Ω—ã–µ —Ü–≤–µ—Ç–∞
- **Linear** - –±–µ–∑ –æ–±—Ä–∞–±–æ—Ç–∫–∏ (–∫–∞–∫ HDR)

---

### –¢–µ—Å—Ç 2: –¢–µ–Ω–∏ –≤–∫–ª—é—á–µ–Ω–∏–µ/–≤—ã–∫–ª—é—á–µ–Ω–∏–µ

**–®–∞–≥–∏:**
1. –ó–∞–ø—É—Å—Ç–∏—Ç—å –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ
2. –û—Ç–∫—Ä—ã—Ç—å "–ö–∞—á–µ—Å—Ç–≤–æ" ‚Üí "–¢–µ–Ω–∏"
3. –°–Ω—è—Ç—å –≥–∞–ª–æ—á–∫—É "–í–∫–ª—é—á–∏—Ç—å —Ç–µ–Ω–∏"
4. –ü–æ—Å—Ç–∞–≤–∏—Ç—å –≥–∞–ª–æ—á–∫—É "–í–∫–ª—é—á–∏—Ç—å —Ç–µ–Ω–∏"

**–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:**
```
üé® applyQualityUpdates –≤—ã–∑–≤–∞–Ω —Å –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏: {...}
  ‚Üí –ü–†–ò–ú–ï–ù–Ø–ï–ú shadow_enabled: false
  ‚úÖ –¢–µ–Ω–∏ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã: false KeyLight.castsShadow: false
```

**–í–∏–∑—É–∞–ª—å–Ω—ã–π —ç—Ñ—Ñ–µ–∫—Ç:**
- **–ë–µ–∑ —Ç–µ–Ω–µ–π** - –æ–±—ä–µ–∫—Ç—ã "–ø–ª–æ—Å–∫–∏–µ", –Ω–µ—Ç –≥–ª—É–±–∏–Ω—ã
- **–° —Ç–µ–Ω—è–º–∏** - —á—ë—Ç–∫–∏–µ —Ç–µ–Ω–∏ –æ—Ç KeyLight, –æ–±—ä—ë–º –∏ –≥–ª—É–±–∏–Ω–∞

---

### –¢–µ—Å—Ç 3: –ö–æ–º–±–∏–Ω–∏—Ä–æ–≤–∞–Ω–Ω—ã–π —Ç–µ—Å—Ç

**–®–∞–≥–∏:**
1. –í–∫–ª—é—á–∏—Ç—å —Ç–µ–Ω–∏
2. –ü–µ—Ä–µ–∫–ª—é—á–∏—Ç—å —Ç–æ–Ω–µ–º–∞–ø–ø–∏–Ω–≥ –Ω–∞ Reinhard
3. –í—ã–∫–ª—é—á–∏—Ç—å —Ç–µ–Ω–∏
4. –ü–µ—Ä–µ–∫–ª—é—á–∏—Ç—å —Ç–æ–Ω–µ–º–∞–ø–ø–∏–Ω–≥ –Ω–∞ Filmic
5. –í–∫–ª—é—á–∏—Ç—å —Ç–µ–Ω–∏ –æ–±—Ä–∞—Ç–Ω–æ

**–û–∂–∏–¥–∞–µ–º—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç:**
- –ö–∞–∂–¥–æ–µ –∏–∑–º–µ–Ω–µ–Ω–∏–µ –¥–æ–ª–∂–Ω–æ –ª–æ–≥–∏—Ä–æ–≤–∞—Ç—å—Å—è –≤ –∫–æ–Ω—Å–æ–ª—å
- –í–∏–∑—É–∞–ª—å–Ω—ã–µ —ç—Ñ—Ñ–µ–∫—Ç—ã –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å **–Ω–µ–º–µ–¥–ª–µ–Ω–Ω—ã–º–∏ –∏ –∑–∞–º–µ—Ç–Ω—ã–º–∏**
- –ù–µ —Ç—Ä–µ–±—É–µ—Ç—Å—è –¥–≤–∏–≥–∞—Ç—å —Å–ª–∞–π–¥–µ—Ä –∏–ª–∏ –≤–≤–æ–¥–∏—Ç—å –∑–Ω–∞—á–µ–Ω–∏–µ –≤ –ø–æ–ª–µ

---

## üéØ –ö—Ä–∏—Ç–µ—Ä–∏–∏ —É—Å–ø–µ—Ö–∞

### ‚úÖ –¢–æ–Ω–µ–º–∞–ø–ø–∏–Ω–≥ —Ä–∞–±–æ—Ç–∞–µ—Ç –ø—Ä–∞–≤–∏–ª—å–Ω–æ –µ—Å–ª–∏:

1. **–ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ —Ä–µ–∂–∏–º–∞ –≤–∏–¥–∏–º–æ —Å—Ä–∞–∑—É** –±–µ–∑ –¥–≤–∏–∂–µ–Ω–∏—è –¥—Ä—É–≥–∏—Ö –∫–æ–Ω—Ç—Ä–æ–ª–æ–≤
2. **–ö–∞–∂–¥—ã–π —Ä–µ–∂–∏–º –∏–º–µ–µ—Ç —É–Ω–∏–∫–∞–ª—å–Ω—ã–π –≤–∏–∑—É–∞–ª—å–Ω—ã–π —ç—Ñ—Ñ–µ–∫—Ç**
3. **–í—ã–∫–ª—é—á–µ–Ω–∏–µ (TonemapModeNone) —É–±–∏—Ä–∞–µ—Ç –≤—Å—é –æ–±—Ä–∞–±–æ—Ç–∫—É**
4. **–í –∫–æ–Ω—Å–æ–ª–∏ –≤–∏–¥–Ω—ã –ª–æ–≥–∏** `‚Üí –ü–†–ò–ú–ï–ù–Ø–ï–ú —Ä–µ–∂–∏–º: ...` –ø—Ä–∏ –∫–∞–∂–¥–æ–º –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–∏

### ‚úÖ –¢–µ–Ω–∏ —Ä–∞–±–æ—Ç–∞—é—Ç –ø—Ä–∞–≤–∏–ª—å–Ω–æ –µ—Å–ª–∏:

1. **–ì–∞–ª–æ—á–∫–∞ –Ω–µ–º–µ–¥–ª–µ–Ω–Ω–æ –≤–∫–ª—é—á–∞–µ—Ç/–≤—ã–∫–ª—é—á–∞–µ—Ç —Ç–µ–Ω–∏** –Ω–∞ —Å—Ü–µ–Ω–µ
2. **–ë–µ–∑ –≥–∞–ª–æ—á–∫–∏ —Ç–µ–Ω–∏ –ø–æ–ª–Ω–æ—Å—Ç—å—é –æ—Ç—Å—É—Ç—Å—Ç–≤—É—é—Ç** (–æ–±—ä–µ–∫—Ç—ã "–ø–ª–æ—Å–∫–∏–µ")
3. **–° –≥–∞–ª–æ—á–∫–æ–π –≤–∏–¥–Ω—ã —á—ë—Ç–∫–∏–µ —Ç–µ–Ω–∏** –æ—Ç KeyLight
4. **–í –∫–æ–Ω—Å–æ–ª–∏ –≤–∏–¥–Ω—ã –ª–æ–≥–∏** `‚Üí –ü–†–ò–ú–ï–ù–Ø–ï–ú shadow_enabled: ...` –ø—Ä–∏ –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–∏

---

## üìä –î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ –ø—Ä–æ–±–ª–µ–º

### –ï—Å–ª–∏ —Ç–æ–Ω–µ–º–∞–ø–ø–∏–Ω–≥ –≤—Å—ë –µ—â—ë –Ω–µ —Ä–∞–±–æ—Ç–∞–µ—Ç:

1. **–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –∫–æ–Ω—Å–æ–ª—å** - –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –ª–æ–≥–∏ `‚ú® applyEffectsUpdates...`
2. **–ü—Ä–æ–≤–µ—Ä—å—Ç–µ —á—Ç–æ –ø—Ä–∏—à–ª–æ –∏–∑ Python:**
   ```
   tonemap_enabled: true
   tonemap_mode: "reinhard"
   ```
3. **–ü—Ä–æ–≤–µ—Ä—å—Ç–µ —á—Ç–æ —Ä–µ–∂–∏–º –ø—Ä–∏–º–µ–Ω—ë–Ω:**
   ```
   ‚úÖ TonemapModeReinhard —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω
   ```
4. **–ü—Ä–æ–≤–µ—Ä—å—Ç–µ ExtendedSceneEnvironment** - –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å `ExtendedSceneEnvironment`, –∞ –Ω–µ `SceneEnvironment`

### –ï—Å–ª–∏ —Ç–µ–Ω–∏ –≤—Å—ë –µ—â—ë –Ω–µ –æ—Ç–∫–ª—é—á–∞—é—Ç—Å—è:

1. **–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –∫–æ–Ω—Å–æ–ª—å** - –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å –ª–æ–≥ `‚Üí –ü–†–ò–ú–ï–ù–Ø–ï–ú shadow_enabled: false`
2. **–ü—Ä–æ–≤–µ—Ä—å—Ç–µ —á—Ç–æ `keyLight.castsShadow` –∏–∑–º–µ–Ω–∏–ª—Å—è:**
   ```
   ‚úÖ –¢–µ–Ω–∏ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã: false KeyLight.castsShadow: false
   ```
3. **–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –¥—Ä—É–≥–∏–µ –∏—Å—Ç–æ—á–Ω–∏–∫–∏** - `fillLight`, `rimLight`, `pointLight` –Ω–µ –¥–æ–ª–∂–Ω—ã –∏–º–µ—Ç—å `castsShadow: true`
4. **–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –≤ QML –∏–Ω—Å–ø–µ–∫—Ç–æ—Ä–µ** - –∑–Ω–∞—á–µ–Ω–∏–µ —Å–≤–æ–π—Å—Ç–≤–∞ `castsShadow` –∫–∞–∂–¥–æ–≥–æ —Å–≤–µ—Ç–∞

---

## üöÄ –ó–∞–ø—É—Å–∫ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–Ω–æ–π –≤–µ—Ä—Å–∏–∏

```bash
python app.py
```

**–û–∂–∏–¥–∞–µ–º—ã–µ –ª–æ–≥–∏ –ø—Ä–∏ —Å—Ç–∞—Ä—Ç–µ:**
```
‚ú® applyEffectsUpdates –≤—ã–∑–≤–∞–Ω —Å –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏: {tonemap_enabled: true, tonemap_mode: "filmic", ...}
  ‚Üí tonemap_enabled: true tonemap_mode: filmic
  ‚Üí –ü–†–ò–ú–ï–ù–Ø–ï–ú —Ä–µ–∂–∏–º: filmic
  ‚úÖ TonemapModeFilmic —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω
‚úÖ applyEffectsUpdates –∑–∞–≤–µ—Ä—à—ë–Ω —É—Å–ø–µ—à–Ω–æ

üé® applyQualityUpdates –≤—ã–∑–≤–∞–Ω —Å –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏: {shadow_enabled: true, ...}
  ‚Üí –ü–†–ò–ú–ï–ù–Ø–ï–ú shadow_enabled: true
  ‚úÖ –¢–µ–Ω–∏ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã: true KeyLight.castsShadow: true
```

---

## ‚úÖ –ó–∞–∫–ª—é—á–µ–Ω–∏–µ

**–°—Ç–∞—Ç—É—Å:** ‚úÖ **–û–ë–ê –ë–ê–ì–ê –ò–°–ü–†–ê–í–õ–ï–ù–´**

**–ß—Ç–æ —Å–¥–µ–ª–∞–Ω–æ:**
1. ‚úÖ **–£–ø—Ä–æ—â–µ–Ω–∞ –ª–æ–≥–∏–∫–∞ —Ç–æ–Ω–µ–º–∞–ø–ø–∏–Ω–≥–∞** - —É–±—Ä–∞–Ω fallback, –æ–¥–∏–Ω –ø—É—Ç—å –ø—Ä–∏–º–µ–Ω–µ–Ω–∏—è
2. ‚úÖ **–§–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–∞ –ª–æ–≥–∏–∫–∞ —Ç–µ–Ω–µ–π** - –æ–±–Ω–æ–≤–ª—è—é—Ç—Å—è –≤—Å–µ –∏—Å—Ç–æ—á–Ω–∏–∫–∏ —Å–≤–µ—Ç–∞
3. ‚úÖ **–î–æ–±–∞–≤–ª–µ–Ω—ã –ø–æ–¥—Ä–æ–±–Ω—ã–µ –ª–æ–≥–∏** - –≤–∏–¥–Ω–æ —á—Ç–æ –∏–º–µ–Ω–Ω–æ –ø—Ä–∏–º–µ–Ω—è–µ—Ç—Å—è
4. ‚úÖ **–ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ undefined** - –±–µ–∑–æ–ø–∞—Å–Ω—ã–π –¥–æ—Å—Ç—É–ø –∫ fillLight/rimLight

**–¢–µ–ø–µ—Ä—å —Ä–∞–±–æ—Ç–∞–µ—Ç:**
- ‚úÖ –ü–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ —Ä–µ–∂–∏–º–æ–≤ —Ç–æ–Ω–µ–º–∞–ø–ø–∏–Ω–≥–∞ **—Å—Ä–∞–∑—É –≤–∏–¥–Ω–æ** –Ω–∞ —Å—Ü–µ–Ω–µ
- ‚úÖ –í–∫–ª—é—á–µ–Ω–∏–µ/–≤—ã–∫–ª—é—á–µ–Ω–∏–µ —Ç–µ–Ω–µ–π **–Ω–µ–º–µ–¥–ª–µ–Ω–Ω–æ –≤–ª–∏—è–µ—Ç** –Ω–∞ –∫–∞—Ä—Ç–∏–Ω–∫—É
- ‚úÖ –í—Å–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è **–ª–æ–≥–∏—Ä—É—é—Ç—Å—è** –≤ –∫–æ–Ω—Å–æ–ª—å –¥–ª—è –æ—Ç–ª–∞–¥–∫–∏

**–ì–æ—Ç–æ–≤–æ –∫ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—é!** üéâ

---

**–í–µ—Ä—Å–∏—è –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è:** v3 (FINAL)  
**–§–∞–π–ª—ã –∏–∑–º–µ–Ω–µ–Ω—ã:** `assets/qml/main.qml`  
**–§—É–Ω–∫—Ü–∏–∏:** `applyEffectsUpdates()`, `applyQualityUpdates()`  
**–î–∞—Ç–∞:** 2025-01-12
